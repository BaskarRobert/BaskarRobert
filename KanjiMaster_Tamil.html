<!DOCTYPE html>
<html lang="ta-JP">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>æ¼¢å­—ãƒã‚¹ã‚¿ãƒ¼ â€” Kanji Master Tamil</title>
<style>
/* ============================================================
   KANJI MASTER â€” TAMIL LEARNING APP
   Design: Refined dark academia with ink-brush aesthetic
   Typography: Noto Serif JP + Nunito
   ============================================================ */

@import url('https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700;900&family=Nunito:wght@400;600;700;800&family=Noto+Sans+Tamil:wght@400;600;700&display=swap');

/* â”€â”€ CSS VARIABLES â”€â”€ */
:root {
  --bg: #0f0e13;
  --bg2: #16141d;
  --bg3: #1e1b28;
  --card: #211f2e;
  --card2: #2a2739;
  --border: #38344d;
  --border2: #4a4566;
  --text: #f0edf8;
  --text2: #b8b0d4;
  --text3: #7a7290;
  --accent: #e8a045;
  --accent2: #f0c070;
  --accent3: #c47c20;
  --red: #e05555;
  --green: #4caf7d;
  --blue: #5b8dee;
  --purple: #9b6ee8;
  --pink: #e86ea8;
  --teal: #3dbdb8;
  --ink: #2d1f4a;
  --radius: 16px;
  --radius-sm: 10px;
  --shadow: 0 8px 32px rgba(0,0,0,0.5);
  --shadow-sm: 0 4px 16px rgba(0,0,0,0.3);
  --transition: all 0.25s cubic-bezier(0.4,0,0.2,1);
}

/* â”€â”€ RESET & BASE â”€â”€ */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { height: 100%; font-size: 16px; }
body {
  font-family: 'Nunito', 'Noto Sans Tamil', sans-serif;
  background: var(--bg);
  color: var(--text);
  height: 100%;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  -webkit-font-smoothing: antialiased;
}

/* â”€â”€ SCROLLBARS â”€â”€ */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: var(--bg2); }
::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 3px; }

/* â”€â”€ RUBY / FURIGANA â”€â”€ */
ruby { ruby-position: over; }
rt { font-size: 0.55em; color: var(--accent2); letter-spacing: 0.05em; font-family: 'Noto Serif JP', serif; }
rp { display: none; }

/* â”€â”€ TOP HEADER â”€â”€ */
#app-header {
  background: linear-gradient(135deg, #1a1726 0%, #211f2e 100%);
  border-bottom: 1px solid var(--border);
  padding: 0 16px;
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-shrink: 0;
  position: relative;
  z-index: 100;
  box-shadow: 0 2px 20px rgba(0,0,0,0.4);
}
.app-logo {
  font-family: 'Noto Serif JP', serif;
  font-size: 1.1rem;
  font-weight: 900;
  background: linear-gradient(135deg, var(--accent) 0%, var(--accent2) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  letter-spacing: 0.03em;
}
.app-logo span { font-family: 'Nunito', sans-serif; font-size: 0.7rem; font-weight: 700; color: var(--text3); -webkit-text-fill-color: var(--text3); display: block; margin-top: -2px; }
.header-stats { display: flex; gap: 12px; align-items: center; }
.hstat { text-align: center; }
.hstat-val { font-size: 1.05rem; font-weight: 800; color: var(--accent); line-height: 1; }
.hstat-lbl { font-size: 0.6rem; color: var(--text3); text-transform: uppercase; letter-spacing: 0.06em; }
.streak-badge {
  background: linear-gradient(135deg, #e05555, #e8a045);
  border-radius: 20px;
  padding: 4px 10px;
  font-size: 0.75rem;
  font-weight: 800;
  display: flex;
  align-items: center;
  gap: 4px;
}

/* â”€â”€ MAIN CONTENT AREA â”€â”€ */
#app-main {
  flex: 1;
  overflow: hidden;
  position: relative;
}

/* â”€â”€ VIEWS â”€â”€ */
.view {
  position: absolute;
  inset: 0;
  overflow-y: auto;
  padding: 16px;
  display: none;
  animation: fadeSlide 0.3s ease;
}
.view.active { display: block; }

@keyframes fadeSlide {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

/* â”€â”€ BOTTOM NAV â”€â”€ */
#bottom-nav {
  background: var(--bg2);
  border-top: 1px solid var(--border);
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  flex-shrink: 0;
  height: 60px;
  z-index: 100;
}
.nav-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 3px;
  cursor: pointer;
  transition: var(--transition);
  border: none;
  background: none;
  color: var(--text3);
  padding: 6px 2px;
  position: relative;
}
.nav-btn.active { color: var(--accent); }
.nav-btn.active::before {
  content: '';
  position: absolute;
  top: 0;
  left: 20%;
  right: 20%;
  height: 2px;
  background: var(--accent);
  border-radius: 0 0 4px 4px;
}
.nav-icon { font-size: 1.3rem; line-height: 1; }
.nav-label { font-size: 0.58rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.04em; }

/* â”€â”€ CARDS â”€â”€ */
.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px;
  margin-bottom: 12px;
  transition: var(--transition);
}
.card:active { transform: scale(0.98); }
.card-sm { padding: 12px; border-radius: var(--radius-sm); }

/* â”€â”€ SECTION TITLE â”€â”€ */
.section-title {
  font-size: 0.7rem;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--text3);
  margin: 20px 0 10px;
}
.section-title:first-child { margin-top: 4px; }

/* â”€â”€ BUTTONS â”€â”€ */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 10px 18px;
  border-radius: 50px;
  border: none;
  cursor: pointer;
  font-family: inherit;
  font-weight: 700;
  font-size: 0.85rem;
  transition: var(--transition);
  text-decoration: none;
}
.btn-primary { background: linear-gradient(135deg, var(--accent), var(--accent2)); color: #1a1200; }
.btn-primary:hover { opacity: 0.9; transform: translateY(-1px); box-shadow: 0 4px 20px rgba(232,160,69,0.4); }
.btn-ghost { background: var(--card2); color: var(--text); border: 1px solid var(--border); }
.btn-ghost:hover { border-color: var(--accent); color: var(--accent); }
.btn-success { background: linear-gradient(135deg, var(--green), #6dd98e); color: #0a1f12; }
.btn-danger { background: linear-gradient(135deg, var(--red), #f07070); color: #fff; }
.btn-sm { padding: 7px 14px; font-size: 0.78rem; }
.btn-block { width: 100%; }

/* â”€â”€ TAGS / BADGES â”€â”€ */
.tag {
  display: inline-flex;
  align-items: center;
  padding: 3px 8px;
  border-radius: 20px;
  font-size: 0.62rem;
  font-weight: 800;
  letter-spacing: 0.04em;
  text-transform: uppercase;
}
.tag-n5 { background: rgba(76,175,125,0.2); color: var(--green); border: 1px solid rgba(76,175,125,0.3); }
.tag-n4 { background: rgba(91,141,238,0.2); color: var(--blue); border: 1px solid rgba(91,141,238,0.3); }
.tag-n3 { background: rgba(155,110,232,0.2); color: var(--purple); border: 1px solid rgba(155,110,232,0.3); }
.tag-n2 { background: rgba(232,110,168,0.2); color: var(--pink); border: 1px solid rgba(232,110,168,0.3); }
.tag-n1 { background: rgba(224,85,85,0.2); color: var(--red); border: 1px solid rgba(224,85,85,0.3); }
.tag-known { background: rgba(76,175,125,0.25); color: var(--green); }
.tag-review { background: rgba(232,160,69,0.25); color: var(--accent); }
.tag-difficult { background: rgba(224,85,85,0.25); color: var(--red); }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   HOME VIEW
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.hero-kanji {
  background: linear-gradient(135deg, var(--ink) 0%, #1a1535 50%, #2d1f4a 100%);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 24px;
  margin-bottom: 16px;
  text-align: center;
  position: relative;
  overflow: hidden;
}
.hero-kanji::before {
  content: 'æ¼¢å­—';
  position: absolute;
  font-family: 'Noto Serif JP', serif;
  font-size: 10rem;
  font-weight: 900;
  color: rgba(255,255,255,0.02);
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  pointer-events: none;
  user-select: none;
}
.hero-title { font-size: 1.6rem; font-weight: 800; color: var(--text); margin-bottom: 4px; }
.hero-sub { font-size: 0.85rem; color: var(--text2); margin-bottom: 16px; }
.progress-overview { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
.prog-item { background: var(--bg3); border-radius: 10px; padding: 10px 8px; text-align: center; border: 1px solid var(--border); }
.prog-num { font-size: 1.4rem; font-weight: 800; color: var(--accent); font-family: 'Noto Serif JP', serif; }
.prog-lbl { font-size: 0.6rem; color: var(--text3); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 2px; }

.quick-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 16px; }
.quick-btn {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px;
  cursor: pointer;
  transition: var(--transition);
  text-align: left;
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.quick-btn:hover, .quick-btn:active { border-color: var(--accent); transform: translateY(-2px); box-shadow: var(--shadow-sm); }
.quick-icon { font-size: 1.6rem; }
.quick-title { font-weight: 800; font-size: 0.85rem; color: var(--text); }
.quick-sub { font-size: 0.7rem; color: var(--text3); }

.daily-kanji-card {
  background: linear-gradient(135deg, var(--card) 0%, var(--card2) 100%);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 20px;
  cursor: pointer;
  transition: var(--transition);
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 16px;
}
.daily-kanji-card:hover { border-color: var(--accent); }
.daily-char {
  font-family: 'Noto Serif JP', serif;
  font-size: 3.5rem;
  font-weight: 900;
  color: var(--accent2);
  line-height: 1;
  text-shadow: 0 0 30px rgba(240,192,112,0.3);
  flex-shrink: 0;
}
.daily-info { flex: 1; min-width: 0; }
.daily-meaning { font-size: 1rem; font-weight: 800; color: var(--text); margin-bottom: 4px; }
.daily-tamil { font-size: 0.8rem; color: var(--accent); font-family: 'Noto Sans Tamil', sans-serif; margin-bottom: 6px; }
.daily-readings { display: flex; gap: 8px; flex-wrap: wrap; }
.reading-pill {
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 20px;
  padding: 2px 8px;
  font-size: 0.65rem;
  font-family: 'Noto Serif JP', serif;
  color: var(--text2);
}
.reading-pill.on { color: var(--blue); border-color: rgba(91,141,238,0.3); background: rgba(91,141,238,0.1); }
.reading-pill.kun { color: var(--teal); border-color: rgba(61,189,184,0.3); background: rgba(61,189,184,0.1); }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   LESSON LIST VIEW
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.lesson-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px;
  margin-bottom: 10px;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 14px;
}
.lesson-card:hover { border-color: var(--accent); transform: translateX(3px); }
.lesson-num {
  width: 44px; height: 44px;
  border-radius: 12px;
  background: linear-gradient(135deg, var(--ink), var(--card2));
  border: 1px solid var(--border);
  display: flex; align-items: center; justify-content: center;
  font-family: 'Noto Serif JP', serif;
  font-size: 1.1rem;
  font-weight: 900;
  color: var(--accent2);
  flex-shrink: 0;
}
.lesson-info { flex: 1; min-width: 0; }
.lesson-name { font-weight: 800; font-size: 0.9rem; margin-bottom: 3px; }
.lesson-meta { font-size: 0.7rem; color: var(--text3); display: flex; gap: 10px; align-items: center; }
.lesson-progress { height: 4px; background: var(--bg3); border-radius: 2px; margin-top: 6px; overflow: hidden; }
.lesson-progress-bar { height: 100%; background: linear-gradient(90deg, var(--accent), var(--accent2)); border-radius: 2px; transition: width 0.5s ease; }
.lesson-arrow { color: var(--text3); font-size: 1.1rem; }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   KANJI LIBRARY VIEW
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.search-bar {
  display: flex;
  align-items: center;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 50px;
  padding: 10px 16px;
  gap: 8px;
  margin-bottom: 12px;
  transition: var(--transition);
}
.search-bar:focus-within { border-color: var(--accent); }
.search-bar input {
  background: none;
  border: none;
  outline: none;
  color: var(--text);
  font-family: inherit;
  font-size: 0.9rem;
  flex: 1;
  min-width: 0;
}
.search-bar input::placeholder { color: var(--text3); }
.search-icon { color: var(--text3); font-size: 1rem; }

.filter-row { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 4px; margin-bottom: 12px; }
.filter-row::-webkit-scrollbar { display: none; }
.filter-chip {
  padding: 6px 12px;
  border-radius: 20px;
  border: 1px solid var(--border);
  background: var(--card);
  color: var(--text2);
  font-size: 0.72rem;
  font-weight: 700;
  cursor: pointer;
  white-space: nowrap;
  transition: var(--transition);
  flex-shrink: 0;
}
.filter-chip.active { background: var(--accent); color: #1a1200; border-color: var(--accent); }

.kanji-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
@media (min-width: 480px) { .kanji-grid { grid-template-columns: repeat(5, 1fr); } }
@media (min-width: 768px) { .kanji-grid { grid-template-columns: repeat(7, 1fr); } }

.kanji-tile {
  aspect-ratio: 1;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: var(--transition);
  position: relative;
  overflow: hidden;
}
.kanji-tile:hover { border-color: var(--accent); transform: scale(1.05); z-index: 1; }
.kanji-tile.status-known { border-color: rgba(76,175,125,0.4); background: rgba(76,175,125,0.05); }
.kanji-tile.status-review { border-color: rgba(232,160,69,0.4); background: rgba(232,160,69,0.05); }
.kanji-tile.status-difficult { border-color: rgba(224,85,85,0.4); background: rgba(224,85,85,0.05); }
.tile-char {
  font-family: 'Noto Serif JP', serif;
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--text);
  line-height: 1;
}
.tile-mean { font-size: 0.45rem; color: var(--text3); margin-top: 3px; text-align: center; padding: 0 2px; line-height: 1.2; max-width: 100%; overflow: hidden; }
.tile-status-dot {
  position: absolute;
  top: 4px;
  right: 4px;
  width: 6px; height: 6px;
  border-radius: 50%;
}
.status-known .tile-status-dot { background: var(--green); }
.status-review .tile-status-dot { background: var(--accent); }
.status-difficult .tile-status-dot { background: var(--red); }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   KANJI DETAIL MODAL
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#kanji-modal {
  position: fixed;
  inset: 0;
  z-index: 1000;
  display: none;
  align-items: flex-end;
  background: rgba(0,0,0,0.7);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  animation: fadeIn 0.2s ease;
}
#kanji-modal.open { display: flex; }

@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

.modal-sheet {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: var(--radius) var(--radius) 0 0;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
  animation: slideUp 0.3s cubic-bezier(0.4,0,0.2,1);
  padding: 20px;
  padding-bottom: 32px;
}

@keyframes slideUp {
  from { transform: translateY(100%); }
  to { transform: translateY(0); }
}

.modal-handle {
  width: 36px; height: 4px;
  background: var(--border2);
  border-radius: 2px;
  margin: 0 auto 20px;
}

.modal-kanji-display {
  text-align: center;
  margin-bottom: 20px;
}
.modal-kanji-char {
  font-family: 'Noto Serif JP', serif;
  font-size: 6rem;
  font-weight: 900;
  color: var(--accent2);
  line-height: 1;
  text-shadow: 0 0 60px rgba(240,192,112,0.2);
  display: block;
}
.modal-kanji-top { display: flex; align-items: center; justify-content: center; gap: 12px; margin-bottom: 8px; flex-wrap: wrap; }
.modal-meaning-en { font-size: 1.2rem; font-weight: 800; color: var(--text); }
.modal-meaning-ta { font-size: 1rem; color: var(--accent); font-family: 'Noto Sans Tamil', sans-serif; margin: 4px 0 8px; }
.modal-tamil-exp { font-size: 0.8rem; color: var(--text2); font-family: 'Noto Sans Tamil', sans-serif; line-height: 1.6; margin-bottom: 12px; }

.readings-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 16px; }
.reading-box {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 12px;
}
.reading-type { font-size: 0.62rem; text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 6px; font-weight: 800; }
.on-type { color: var(--blue); }
.kun-type { color: var(--teal); }
.reading-value { font-family: 'Noto Serif JP', serif; font-size: 1rem; color: var(--text); }

.examples-section { margin-bottom: 16px; }
.example-item {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 12px;
  margin-bottom: 8px;
}
.example-word { font-family: 'Noto Serif JP', serif; font-size: 1.1rem; color: var(--text); margin-bottom: 4px; }
.example-reading { font-size: 0.72rem; color: var(--text3); margin-bottom: 4px; }
.example-tamil { font-size: 0.8rem; color: var(--text2); font-family: 'Noto Sans Tamil', sans-serif; }

.status-buttons { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 16px; }
.status-btn {
  padding: 10px 6px;
  border-radius: 10px;
  border: 2px solid;
  background: none;
  cursor: pointer;
  font-family: inherit;
  font-size: 0.72rem;
  font-weight: 800;
  transition: var(--transition);
  text-align: center;
}
.status-btn.known { border-color: var(--green); color: var(--green); }
.status-btn.review { border-color: var(--accent); color: var(--accent); }
.status-btn.difficult { border-color: var(--red); color: var(--red); }
.status-btn.active.known { background: var(--green); color: #fff; }
.status-btn.active.review { background: var(--accent); color: #1a1200; }
.status-btn.active.difficult { background: var(--red); color: #fff; }

.modal-nav { display: flex; gap: 8px; }
.modal-nav .btn { flex: 1; }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   LESSON DETAIL VIEW
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.lesson-header {
  background: linear-gradient(135deg, var(--ink), var(--card2));
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 20px;
  margin-bottom: 16px;
  text-align: center;
}
.lesson-header-title { font-size: 1.3rem; font-weight: 800; margin-bottom: 4px; }
.lesson-header-sub { font-size: 0.8rem; color: var(--text2); margin-bottom: 12px; }
.lesson-mode-tabs { display: flex; gap: 8px; justify-content: center; }
.mode-tab {
  padding: 8px 16px;
  border-radius: 50px;
  border: 1px solid var(--border);
  background: var(--bg3);
  color: var(--text2);
  font-size: 0.78rem;
  font-weight: 700;
  cursor: pointer;
  transition: var(--transition);
}
.mode-tab.active { background: var(--accent); color: #1a1200; border-color: var(--accent); }

.study-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 30px 20px;
  text-align: center;
  margin-bottom: 16px;
}
.study-card-kanji {
  font-family: 'Noto Serif JP', serif;
  font-size: 5rem;
  font-weight: 900;
  color: var(--accent2);
  text-shadow: 0 0 40px rgba(240,192,112,0.2);
  margin-bottom: 8px;
  line-height: 1;
}
.study-card-meaning { font-size: 1.1rem; font-weight: 800; color: var(--text); margin-bottom: 4px; }
.study-card-tamil { font-size: 0.9rem; color: var(--accent); font-family: 'Noto Sans Tamil', sans-serif; margin-bottom: 12px; }
.study-counter { font-size: 0.75rem; color: var(--text3); margin-bottom: 16px; }
.study-nav { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   QUIZ / GAME VIEW
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.game-select { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 16px; }
.game-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 20px 14px;
  cursor: pointer;
  transition: var(--transition);
  text-align: center;
}
.game-card:hover { border-color: var(--accent); transform: translateY(-3px); box-shadow: var(--shadow-sm); }
.game-icon { font-size: 2rem; margin-bottom: 8px; }
.game-name { font-weight: 800; font-size: 0.85rem; color: var(--text); margin-bottom: 4px; }
.game-desc { font-size: 0.68rem; color: var(--text3); line-height: 1.4; }

/* Quiz area */
.quiz-area { display: none; }
.quiz-area.active { display: block; }
.quiz-header { display: flex; align-items: center; gap: 10px; margin-bottom: 16px; }
.quiz-back { background: none; border: none; color: var(--text2); font-size: 1.2rem; cursor: pointer; padding: 4px; }
.quiz-title { font-weight: 800; font-size: 1rem; flex: 1; }
.quiz-score { font-size: 0.8rem; color: var(--accent); font-weight: 700; }

.quiz-question-card {
  background: linear-gradient(135deg, var(--ink), var(--card2));
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 32px 20px;
  text-align: center;
  margin-bottom: 16px;
}
.quiz-q-label { font-size: 0.68rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text3); margin-bottom: 12px; }
.quiz-q-kanji {
  font-family: 'Noto Serif JP', serif;
  font-size: 5rem;
  font-weight: 900;
  color: var(--accent2);
  line-height: 1;
  text-shadow: 0 0 40px rgba(240,192,112,0.2);
  margin-bottom: 8px;
}
.quiz-q-hint { font-size: 0.78rem; color: var(--text3); }

.quiz-options { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 16px; }
.quiz-option {
  background: var(--card);
  border: 2px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 14px 10px;
  cursor: pointer;
  transition: var(--transition);
  font-family: inherit;
  font-size: 0.82rem;
  font-weight: 700;
  color: var(--text);
  text-align: center;
  line-height: 1.4;
}
.quiz-option:hover { border-color: var(--accent2); background: var(--card2); }
.quiz-option.correct { background: rgba(76,175,125,0.2); border-color: var(--green); color: var(--green); }
.quiz-option.wrong { background: rgba(224,85,85,0.2); border-color: var(--red); color: var(--red); }
.quiz-option.disabled { pointer-events: none; }

.quiz-feedback {
  text-align: center;
  padding: 14px;
  border-radius: 12px;
  margin-bottom: 12px;
  font-weight: 800;
  font-size: 0.9rem;
  display: none;
}
.quiz-feedback.show { display: block; }
.quiz-feedback.correct-fb { background: rgba(76,175,125,0.15); color: var(--green); border: 1px solid rgba(76,175,125,0.3); }
.quiz-feedback.wrong-fb { background: rgba(224,85,85,0.15); color: var(--red); border: 1px solid rgba(224,85,85,0.3); }

.quiz-progress-bar {
  height: 6px;
  background: var(--bg3);
  border-radius: 3px;
  margin-bottom: 16px;
  overflow: hidden;
}
.quiz-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  border-radius: 3px;
  transition: width 0.4s ease;
}

/* Flashcard */
.flashcard-wrap {
  perspective: 1200px;
  margin-bottom: 16px;
  cursor: pointer;
}
.flashcard {
  position: relative;
  width: 100%;
  height: 220px;
  transform-style: preserve-3d;
  transition: transform 0.55s cubic-bezier(0.4,0,0.2,1);
}
.flashcard.flipped { transform: rotateY(180deg); }
.flashcard-face {
  position: absolute;
  inset: 0;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  padding: 20px;
}
.flashcard-front { background: linear-gradient(135deg, var(--ink), var(--card2)); }
.flashcard-back { background: var(--card); transform: rotateY(180deg); }
.flashcard-kanji-big {
  font-family: 'Noto Serif JP', serif;
  font-size: 5.5rem;
  font-weight: 900;
  color: var(--accent2);
  text-shadow: 0 0 50px rgba(240,192,112,0.25);
}
.flashcard-tap { font-size: 0.7rem; color: var(--text3); margin-top: 8px; }
.flashcard-back-content { text-align: center; }
.fb-meaning { font-size: 1.1rem; font-weight: 800; color: var(--text); margin-bottom: 4px; }
.fb-tamil { font-size: 0.9rem; color: var(--accent); font-family: 'Noto Sans Tamil', sans-serif; margin-bottom: 8px; }
.fb-readings { display: flex; gap: 6px; justify-content: center; flex-wrap: wrap; margin-bottom: 8px; }
.fc-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

/* Matching game */
.match-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
.match-item {
  background: var(--card);
  border: 2px solid var(--border);
  border-radius: 12px;
  padding: 14px 10px;
  cursor: pointer;
  transition: var(--transition);
  text-align: center;
  font-weight: 700;
}
.match-item.selected { border-color: var(--accent); background: rgba(232,160,69,0.1); }
.match-item.matched { border-color: var(--green); background: rgba(76,175,125,0.1); color: var(--green); pointer-events: none; }
.match-item.wrong-flash { border-color: var(--red); background: rgba(224,85,85,0.1); animation: shake 0.4s ease; }
.match-kanji-item { font-family: 'Noto Serif JP', serif; font-size: 1.6rem; color: var(--accent2); }
.match-meaning-item { font-size: 0.75rem; color: var(--text2); }

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-4px); }
  75% { transform: translateX(4px); }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   WRITING PRACTICE VIEW
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.write-header { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
.write-kanji-info { flex: 1; }
.write-kanji-title { font-family: 'Noto Serif JP', serif; font-size: 2rem; font-weight: 900; color: var(--accent2); }
.write-meaning { font-size: 0.85rem; color: var(--text2); }

.canvas-container {
  background: var(--card);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  padding: 8px;
  margin-bottom: 12px;
  position: relative;
  overflow: hidden;
}
.canvas-container canvas {
  display: block;
  width: 100%;
  border-radius: 10px;
  touch-action: none;
  cursor: crosshair;
  background: #fafaf8;
}
.canvas-overlay-kanji {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-family: 'Noto Serif JP', serif;
  font-size: 8rem;
  font-weight: 900;
  color: rgba(0,0,0,0.05);
  pointer-events: none;
  user-select: none;
  transition: opacity 0.3s;
  line-height: 1;
}
.canvas-controls { display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap; }
.canvas-controls .btn { flex: 1; min-width: 80px; }
.show-hint-toggle { display: flex; align-items: center; gap: 8px; font-size: 0.8rem; color: var(--text2); cursor: pointer; }

.stroke-counter {
  text-align: center;
  font-size: 0.75rem;
  color: var(--text3);
  margin-bottom: 8px;
}

.write-selector {
  display: flex; gap: 8px; overflow-x: auto;
  padding-bottom: 8px; margin-bottom: 12px;
}
.write-selector::-webkit-scrollbar { display: none; }
.write-kanji-btn {
  flex-shrink: 0;
  width: 48px; height: 48px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer;
  transition: var(--transition);
  font-family: 'Noto Serif JP', serif;
  font-size: 1.3rem;
  color: var(--text2);
}
.write-kanji-btn.active { border-color: var(--accent); color: var(--accent2); background: rgba(232,160,69,0.1); }
.write-feedback {
  text-align: center;
  font-size: 0.85rem;
  color: var(--accent);
  font-weight: 700;
  min-height: 24px;
  margin-bottom: 8px;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   PROGRESS VIEW
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 16px; }
.stat-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px;
  text-align: center;
}
.stat-value { font-size: 2rem; font-weight: 800; font-family: 'Noto Serif JP', serif; line-height: 1; margin-bottom: 4px; }
.stat-label { font-size: 0.7rem; color: var(--text3); text-transform: uppercase; letter-spacing: 0.06em; }

.progress-bar-item { margin-bottom: 14px; }
.pb-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
.pb-label { font-size: 0.8rem; font-weight: 700; }
.pb-value { font-size: 0.75rem; color: var(--text3); }
.pb-track { height: 10px; background: var(--bg3); border-radius: 5px; overflow: hidden; }
.pb-fill { height: 100%; border-radius: 5px; transition: width 1s ease; }

.recent-activity { }
.activity-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 0;
  border-bottom: 1px solid var(--border);
}
.activity-item:last-child { border-bottom: none; }
.activity-icon { width: 36px; height: 36px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1rem; flex-shrink: 0; }
.activity-text { flex: 1; font-size: 0.8rem; color: var(--text2); }
.activity-text strong { color: var(--text); }
.activity-time { font-size: 0.65rem; color: var(--text3); }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SETTINGS VIEW
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.settings-section { margin-bottom: 24px; }
.setting-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 0;
  border-bottom: 1px solid var(--border);
}
.setting-row:last-child { border-bottom: none; }
.setting-info { }
.setting-name { font-weight: 700; font-size: 0.9rem; }
.setting-desc { font-size: 0.72rem; color: var(--text3); margin-top: 2px; }
.toggle {
  width: 44px; height: 24px;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 12px;
  position: relative;
  cursor: pointer;
  transition: var(--transition);
  flex-shrink: 0;
}
.toggle.on { background: var(--accent); border-color: var(--accent); }
.toggle::after {
  content: '';
  position: absolute;
  width: 18px; height: 18px;
  background: var(--text3);
  border-radius: 50%;
  top: 2px;
  left: 2px;
  transition: var(--transition);
}
.toggle.on::after { background: #1a1200; left: 22px; }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   TOAST / NOTIFICATIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#toast-container {
  position: fixed;
  top: 70px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 2000;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  pointer-events: none;
}
.toast {
  background: var(--card2);
  border: 1px solid var(--border2);
  border-radius: 50px;
  padding: 8px 18px;
  font-size: 0.8rem;
  font-weight: 700;
  color: var(--text);
  animation: toastIn 0.3s ease;
  box-shadow: var(--shadow);
  white-space: nowrap;
}
.toast.success { border-color: var(--green); color: var(--green); }
.toast.error { border-color: var(--red); color: var(--red); }
@keyframes toastIn {
  from { opacity: 0; transform: translateY(-10px) scale(0.9); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}

/* â”€â”€ UTIL â”€â”€ */
.flex-center { display: flex; align-items: center; justify-content: center; }
.text-center { text-align: center; }
.gap-8 { gap: 8px; }
.mb-8 { margin-bottom: 8px; }
.mb-16 { margin-bottom: 16px; }
.color-green { color: var(--green); }
.color-red { color: var(--red); }
.color-accent { color: var(--accent); }
.color-blue { color: var(--blue); }
.font-jp { font-family: 'Noto Serif JP', serif; }

/* â”€â”€ EMPTY STATE â”€â”€ */
.empty-state { text-align: center; padding: 40px 20px; color: var(--text3); }
.empty-icon { font-size: 3rem; margin-bottom: 12px; }
.empty-text { font-size: 0.9rem; }

/* â”€â”€ SCORE POPUP â”€â”€ */
.score-popup {
  position: fixed;
  inset: 0;
  z-index: 1500;
  background: rgba(0,0,0,0.8);
  display: none;
  align-items: center;
  justify-content: center;
  padding: 24px;
}
.score-popup.open { display: flex; }
.score-popup-card {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 36px 24px;
  text-align: center;
  max-width: 320px;
  width: 100%;
  animation: popIn 0.35s cubic-bezier(0.4,0,0.2,1);
}
@keyframes popIn {
  from { opacity: 0; transform: scale(0.8); }
  to { opacity: 1; transform: scale(1); }
}
.score-big { font-size: 4rem; font-weight: 800; color: var(--accent2); font-family: 'Noto Serif JP', serif; margin: 12px 0; }
.score-label { font-size: 0.8rem; color: var(--text3); text-transform: uppercase; letter-spacing: 0.08em; }
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<header id="app-header">
  <div class="app-logo">
    æ¼¢å­—ãƒã‚¹ã‚¿ãƒ¼
    <span>KANJI MASTER â€” TAMIL</span>
  </div>
  <div class="header-stats">
    <div class="hstat">
      <div class="hstat-val" id="h-known">0</div>
      <div class="hstat-lbl">Known</div>
    </div>
    <div class="streak-badge">
      ğŸ”¥ <span id="h-streak">0</span>
    </div>
  </div>
</header>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MAIN VIEWS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<main id="app-main">

  <!-- â–¶ HOME -->
  <section class="view active" id="view-home">
    <div class="hero-kanji">
      <div class="hero-title">à®¨à®²à¯à®µà®°à®µà¯ ğŸŒ</div>
      <div class="hero-sub">Learn 1000 Kanji with Tamil meanings</div>
      <div class="progress-overview">
        <div class="prog-item"><div class="prog-num" id="stat-total">50</div><div class="prog-lbl">Total</div></div>
        <div class="prog-item"><div class="prog-num color-green" id="stat-known">0</div><div class="prog-lbl">Known</div></div>
        <div class="prog-item"><div class="prog-num color-accent" id="stat-review">0</div><div class="prog-lbl">Review</div></div>
        <div class="prog-item"><div class="prog-num color-red" id="stat-diff">0</div><div class="prog-lbl">Hard</div></div>
      </div>
    </div>

    <div class="section-title">à®‡à®©à¯à®±à¯ˆà®¯ à®•à®à¯à®šà®¿ â€” Kanji of the Day</div>
    <div class="daily-kanji-card" id="daily-card" onclick="openKanjiModal(todayKanjiIndex)">
      <div class="daily-char" id="daily-char">æ—¥</div>
      <div class="daily-info">
        <div class="daily-meaning" id="daily-meaning">Sun / Day</div>
        <div class="daily-tamil" id="daily-tamil">à®šà¯‚à®°à®¿à®¯à®©à¯ / à®¨à®¾à®³à¯</div>
        <div class="daily-readings">
          <span class="reading-pill on" id="daily-on"></span>
          <span class="reading-pill kun" id="daily-kun"></span>
        </div>
      </div>
    </div>

    <div class="section-title">à®µà®¿à®°à¯ˆà®µà¯ à®šà¯†à®¯à®²à¯à®•à®³à¯ â€” Quick Actions</div>
    <div class="quick-actions">
      <div class="quick-btn" onclick="navigate('lessons')">
        <span class="quick-icon">ğŸ“š</span>
        <span class="quick-title">à®ªà®¾à®Ÿà®™à¯à®•à®³à¯</span>
        <span class="quick-sub">Structured lessons</span>
      </div>
      <div class="quick-btn" onclick="navigate('practice')">
        <span class="quick-icon">âœï¸</span>
        <span class="quick-title">à®à®´à¯à®¤à¯ à®ªà®¯à®¿à®±à¯à®šà®¿</span>
        <span class="quick-sub">Writing practice</span>
      </div>
      <div class="quick-btn" onclick="startQuiz('flashcard')">
        <span class="quick-icon">ğŸƒ</span>
        <span class="quick-title">Flashcards</span>
        <span class="quick-sub">Quick review cards</span>
      </div>
      <div class="quick-btn" onclick="startQuiz('mcq')">
        <span class="quick-icon">ğŸ¯</span>
        <span class="quick-title">à®µà®¿à®©à®¾à®Ÿà®¿ à®µà®¿à®©à®¾</span>
        <span class="quick-sub">Multiple choice quiz</span>
      </div>
    </div>

    <div class="section-title">à®¤à¯Šà®Ÿà®°à¯à®¨à¯à®¤à¯ à®ªà®Ÿà®¿à®¯à¯à®™à¯à®•à®³à¯ â€” Continue Learning</div>
    <div id="home-lessons"></div>
  </section>

  <!-- â–¶ LIBRARY -->
  <section class="view" id="view-library">
    <div class="search-bar">
      <span class="search-icon">ğŸ”</span>
      <input type="text" id="lib-search" placeholder="à®•à®à¯à®šà®¿, à®ªà®Ÿà®¿à®ªà¯à®ªà¯, à®…à®²à¯à®²à®¤à¯ à®¤à®®à®¿à®´à¯ à®ªà¯Šà®°à¯à®³à¯ à®¤à¯‡à®Ÿà¯..." oninput="renderLibrary()">
    </div>
    <div class="filter-row" id="lib-filters"></div>
    <div id="lib-count" class="mb-8" style="font-size:0.75rem;color:var(--text3)"></div>
    <div class="kanji-grid" id="kanji-grid"></div>
  </section>

  <!-- â–¶ LESSONS -->
  <section class="view" id="view-lessons">
    <div id="lessons-list-view">
      <div class="section-title">à®ªà®¾à®Ÿ à®…à®®à¯ˆà®ªà¯à®ªà¯ â€” Lesson Modules</div>
      <div id="lessons-list"></div>
    </div>
    <div id="lesson-detail-view" style="display:none"></div>
  </section>

  <!-- â–¶ GAMES / QUIZ -->
  <section class="view" id="view-games">
    <div id="game-select-area">
      <div class="section-title">à®µà®¿à®³à¯ˆà®¯à®¾à®Ÿà¯à®Ÿà¯ & à®µà®¿à®©à®¾ â€” Games & Quizzes</div>
      <div class="game-select">
        <div class="game-card" onclick="startQuiz('mcq')">
          <div class="game-icon">ğŸ¯</div>
          <div class="game-name">à®…à®°à¯à®¤à¯à®¤ à®µà®¿à®©à®¾</div>
          <div class="game-desc">Choose correct Tamil meaning for each kanji</div>
        </div>
        <div class="game-card" onclick="startQuiz('reading')">
          <div class="game-icon">ğŸ“–</div>
          <div class="game-name">à®ªà®Ÿà®¿à®ªà¯à®ªà¯ à®µà®¿à®©à®¾</div>
          <div class="game-desc">Identify Onyomi or Kunyomi reading</div>
        </div>
        <div class="game-card" onclick="startQuiz('match')">
          <div class="game-icon">ğŸ”—</div>
          <div class="game-name">à®ªà¯Šà®°à¯à®¤à¯à®¤à®®à¯</div>
          <div class="game-desc">Match kanji with Tamil meanings</div>
        </div>
        <div class="game-card" onclick="startQuiz('flashcard')">
          <div class="game-icon">ğŸƒ</div>
          <div class="game-name">Flashcards</div>
          <div class="game-desc">Flip cards â€” test yourself</div>
        </div>
      </div>
      <div class="section-title">à®‰à®™à¯à®•à®³à¯ à®šà®¾à®¤à®©à¯ˆà®•à®³à¯ â€” Your Records</div>
      <div id="best-scores"></div>
    </div>
    <!-- Quiz areas injected dynamically -->
    <div id="quiz-mcq-area" class="quiz-area"></div>
    <div id="quiz-reading-area" class="quiz-area"></div>
    <div id="quiz-match-area" class="quiz-area"></div>
    <div id="quiz-flashcard-area" class="quiz-area"></div>
  </section>

  <!-- â–¶ WRITING PRACTICE -->
  <section class="view" id="view-practice">
    <div class="section-title">à®•à®à¯à®šà®¿ à®à®´à¯à®¤à¯à®¤à¯ à®ªà®¯à®¿à®±à¯à®šà®¿ â€” Writing Practice</div>
    <div class="write-selector" id="write-selector"></div>
    <div class="write-header">
      <div class="write-kanji-title font-jp" id="write-current-char">æ—¥</div>
      <div class="write-kanji-info">
        <div id="write-current-meaning" style="font-weight:800;font-size:0.9rem"></div>
        <div class="write-meaning" id="write-current-tamil"></div>
        <div id="write-current-readings" style="display:flex;gap:6px;margin-top:4px;flex-wrap:wrap"></div>
      </div>
    </div>
    <div class="canvas-container">
      <canvas id="writing-canvas"></canvas>
      <div class="canvas-overlay-kanji" id="canvas-hint"></div>
    </div>
    <div class="stroke-counter">Strokes drawn: <span id="stroke-count">0</span></div>
    <div class="write-feedback" id="write-feedback"></div>
    <div class="canvas-controls">
      <button class="btn btn-ghost btn-sm" onclick="clearCanvas()">ğŸ—‘ï¸ Clear</button>
      <button class="btn btn-ghost btn-sm" onclick="undoStroke()">â†©ï¸ Undo</button>
      <button class="btn btn-ghost btn-sm" onclick="toggleHint()">ğŸ’¡ Hint</button>
      <button class="btn btn-primary btn-sm" onclick="writingDone()">âœ… Done</button>
    </div>
    <div class="section-title">Stroke Tips</div>
    <div class="card card-sm" id="stroke-tips">
      <div style="font-size:0.8rem;color:var(--text2);line-height:1.7">
        âœï¸ <strong>Basic stroke rules:</strong><br>
        1. Generally left â†’ right, top â†’ bottom<br>
        2. Horizontal strokes before vertical (when crossing)<br>
        3. Outside frame before inside content<br>
        4. Center before sides in symmetric kanji<br>
        ğŸ’¡ Tap <strong>Hint</strong> to see the faint guide character
      </div>
    </div>
  </section>

  <!-- â–¶ PROGRESS -->
  <section class="view" id="view-progress">
    <div class="section-title">à®‰à®™à¯à®•à®³à¯ à®®à¯à®©à¯à®©à¯‡à®±à¯à®±à®®à¯ â€” Your Progress</div>
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value color-accent" id="pg-known">0</div>
        <div class="stat-label">Known çŸ¥ã£ã¦ã„ã‚‹</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" style="color:var(--accent2)" id="pg-streak">0</div>
        <div class="stat-label">Day Streak ğŸ”¥</div>
      </div>
      <div class="stat-card">
        <div class="stat-value color-red" id="pg-diff">0</div>
        <div class="stat-label">Difficult é›£ã—ã„</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" style="color:var(--blue)" id="pg-quiz">0</div>
        <div class="stat-label">Quizzes Done</div>
      </div>
    </div>

    <div class="section-title">JLPT à®¨à®¿à®²à¯ˆ à®®à¯à®©à¯à®©à¯‡à®±à¯à®±à®®à¯ â€” Level Progress</div>
    <div class="card">
      <div id="jlpt-progress"></div>
    </div>

    <div class="section-title">à®šà®®à¯€à®ªà®¤à¯à®¤à®¿à®¯ à®šà¯†à®¯à®²à¯à®ªà®¾à®Ÿà¯ â€” Recent Activity</div>
    <div class="card">
      <div id="recent-activity"></div>
    </div>
  </section>

  <!-- â–¶ SETTINGS -->
  <section class="view" id="view-settings">
    <div class="section-title">à®…à®®à¯ˆà®ªà¯à®ªà¯à®•à®³à¯ â€” Settings</div>
    <div class="card">
      <div class="settings-section">
        <div class="setting-row">
          <div class="setting-info">
            <div class="setting-name">Furigana à®à®ªà¯à®ªà¯‹à®¤à¯à®®à¯ à®•à®¾à®Ÿà¯à®Ÿà¯</div>
            <div class="setting-desc">Always show readings above kanji</div>
          </div>
          <div class="toggle" id="toggle-furigana" onclick="toggleSetting('furigana')"></div>
        </div>
        <div class="setting-row">
          <div class="setting-info">
            <div class="setting-name">Writing Hint à®†à®Ÿà¯à®Ÿà¯‹ à®•à®¾à®Ÿà¯à®Ÿà¯</div>
            <div class="setting-desc">Automatically show kanji hint on canvas</div>
          </div>
          <div class="toggle on" id="toggle-hint" onclick="toggleSetting('hint')"></div>
        </div>
        <div class="setting-row">
          <div class="setting-info">
            <div class="setting-name">Sound Effects</div>
            <div class="setting-desc">Play sound on correct/incorrect answers</div>
          </div>
          <div class="toggle" id="toggle-sound" onclick="toggleSetting('sound')"></div>
        </div>
      </div>
    </div>

    <div class="section-title">à®¤à®°à®µà¯ â€” Data</div>
    <div class="card">
      <div class="settings-section">
        <div class="setting-row">
          <div class="setting-info">
            <div class="setting-name">Export Progress</div>
            <div class="setting-desc">Download your study data</div>
          </div>
          <button class="btn btn-ghost btn-sm" onclick="exportData()">Export</button>
        </div>
        <div class="setting-row">
          <div class="setting-info">
            <div class="setting-name color-red">Reset All Progress</div>
            <div class="setting-desc">Clear all stored data (cannot undo)</div>
          </div>
          <button class="btn btn-danger btn-sm" onclick="resetData()">Reset</button>
        </div>
      </div>
    </div>

    <div class="section-title">à®ªà®¯à®©à¯à®ªà®¾à®Ÿà¯à®Ÿà¯ à®ªà®±à¯à®±à®¿ â€” About</div>
    <div class="card card-sm text-center" style="color:var(--text3);font-size:0.78rem;line-height:1.8">
      <div style="font-size:1.5rem;margin-bottom:8px">æ¼¢å­—ãƒã‚¹ã‚¿ãƒ¼</div>
      <strong style="color:var(--text)">Kanji Master Tamil v1.0</strong><br>
      1000 Essential Kanji with Tamil Meanings<br>
      Designed for Tamil-speaking Japanese learners<br>
      <span style="color:var(--accent)">à®¤à®®à®¿à®´à®°à®¿à®©à¯ à®œà®ªà¯à®ªà®¾à®©à®¿à®¯ à®®à¯Šà®´à®¿ à®•à®±à¯à®±à®²à¯ à®¤à®³à®®à¯</span>
    </div>
  </section>

</main>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     BOTTOM NAVIGATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<nav id="bottom-nav">
  <button class="nav-btn active" onclick="navigate('home')" data-view="home">
    <span class="nav-icon">ğŸ </span>
    <span class="nav-label">Home</span>
  </button>
  <button class="nav-btn" onclick="navigate('library')" data-view="library">
    <span class="nav-icon">ğŸ“š</span>
    <span class="nav-label">Library</span>
  </button>
  <button class="nav-btn" onclick="navigate('lessons')" data-view="lessons">
    <span class="nav-icon">ğŸ“</span>
    <span class="nav-label">Lessons</span>
  </button>
  <button class="nav-btn" onclick="navigate('games')" data-view="games">
    <span class="nav-icon">ğŸ®</span>
    <span class="nav-label">Games</span>
  </button>
  <button class="nav-btn" onclick="navigate('practice')" data-view="practice">
    <span class="nav-icon">âœï¸</span>
    <span class="nav-label">Write</span>
  </button>
  <button class="nav-btn" onclick="navigate('progress')" data-view="progress">
    <span class="nav-icon">ğŸ“Š</span>
    <span class="nav-label">Progress</span>
  </button>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     KANJI DETAIL MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="kanji-modal" onclick="if(event.target===this)closeModal()">
  <div class="modal-sheet" id="modal-content">
    <div class="modal-handle"></div>
    <!-- content injected by JS -->
  </div>
</div>

<!-- Score Popup -->
<div class="score-popup" id="score-popup">
  <div class="score-popup-card">
    <div id="sp-emoji" style="font-size:2.5rem">ğŸ‰</div>
    <div class="score-label">Quiz Complete!</div>
    <div class="score-big" id="sp-score">8/10</div>
    <div id="sp-msg" style="font-size:0.85rem;color:var(--text2);margin-bottom:20px"></div>
    <button class="btn btn-primary btn-block" onclick="closeScorePopup()">à®¤à¯Šà®Ÿà®°à¯ â€” Continue</button>
  </div>
</div>

<!-- Toast container -->
<div id="toast-container"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JAVASCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
// ============================================================
// KANJI DATA STRUCTURE
// Each kanji object contains:
//   char: the kanji character
//   onyomi: Chinese-origin readings (array)
//   kunyomi: Japanese-origin readings (array)
//   meaning: English meaning
//   tamil: Tamil meaning
//   tamilExp: Tamil explanation
//   examples: array of {word, reading, tamil}
//   jlpt: JLPT level (N5-N1)
//   strokes: stroke count
//   lesson: lesson number (1-based)
//
// TO ADD MORE KANJI: extend the KANJI array below
// ============================================================

const KANJI = [
  // â”€â”€â”€ LESSON 1: Basic Elements â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  { char:"æ—¥", onyomi:["ãƒ‹ãƒ","ã‚¸ãƒ„"], kunyomi:["ã²","ã‹"], meaning:"Sun / Day", tamil:"à®šà¯‚à®°à®¿à®¯à®©à¯ / à®¨à®¾à®³à¯", tamilExp:"à®šà¯‚à®°à®¿à®¯à®©à¯ à®…à®²à¯à®²à®¤à¯ à®’à®°à¯ à®¨à®¾à®³à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯. 'à®¨à®¾à®³à¯ˆ' à®à®©à¯à®©à¯à®®à¯ à®µà®¾à®°à¯à®¤à¯à®¤à¯ˆà®¯à®¿à®²à¯à®®à¯ à®‡à®¤à¯ à®µà®°à¯à®®à¯.", examples:[{word:"æ—¥æœ¬",reading:"ã«ã»ã‚“",tamil:"à®œà®ªà¯à®ªà®¾à®©à¯"},{word:"æ¯æ—¥",reading:"ã¾ã„ã«ã¡",tamil:"à®¤à®¿à®©à®®à¯à®®à¯"}], jlpt:"N5", strokes:4, lesson:1 },
  { char:"æœˆ", onyomi:["ã‚²ãƒ„","ã‚¬ãƒ„"], kunyomi:["ã¤ã"], meaning:"Moon / Month", tamil:"à®¨à®¿à®²à®µà¯ / à®®à®¾à®¤à®®à¯", tamilExp:"à®¨à®¿à®²à®µà¯ˆ à®…à®²à¯à®²à®¤à¯ à®’à®°à¯ à®®à®¾à®¤à®¤à¯à®¤à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"æœˆæ›œæ—¥",reading:"ã’ã¤ã‚ˆã†ã³",tamil:"à®¤à®¿à®™à¯à®•à®Ÿà¯à®•à®¿à®´à®®à¯ˆ"},{word:"ä¸‰æœˆ",reading:"ã•ã‚“ãŒã¤",tamil:"à®®à®¾à®°à¯à®šà¯ à®®à®¾à®¤à®®à¯"}], jlpt:"N5", strokes:4, lesson:1 },
  { char:"ç«", onyomi:["ã‚«"], kunyomi:["ã²"], meaning:"Fire", tamil:"à®¨à¯†à®°à¯à®ªà¯à®ªà¯", tamilExp:"à®¨à¯†à®°à¯à®ªà¯à®ªà¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿. à®šà¯†à®µà¯à®µà®¾à®¯à¯ à®•à®¿à®´à®®à¯ˆà®¯à®¿à®²à¯à®®à¯ à®‡à®¤à¯ à®µà®°à¯à®®à¯.", examples:[{word:"ç«æ›œæ—¥",reading:"ã‹ã‚ˆã†ã³",tamil:"à®šà¯†à®µà¯à®µà®¾à®¯à¯"},{word:"ç«å±±",reading:"ã‹ã–ã‚“",tamil:"à®à®°à®¿à®®à®²à¯ˆ"}], jlpt:"N5", strokes:4, lesson:1 },
  { char:"æ°´", onyomi:["ã‚¹ã‚¤"], kunyomi:["ã¿ãš"], meaning:"Water", tamil:"à®¨à¯€à®°à¯ / à®¤à®£à¯à®£à¯€à®°à¯", tamilExp:"à®¨à¯€à®°à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯. à®ªà¯à®¤à®©à¯ à®•à®¿à®´à®®à¯ˆà®•à¯à®•à¯à®®à¯ à®‡à®¨à¯à®¤ à®•à®à¯à®šà®¿ à®ªà®¯à®©à¯à®ªà®Ÿà¯à®¤à¯à®¤à®ªà¯à®ªà®Ÿà¯à®®à¯.", examples:[{word:"æ°´æ›œæ—¥",reading:"ã™ã„ã‚ˆã†ã³",tamil:"à®ªà¯à®¤à®©à¯"},{word:"æ°´æ³³",reading:"ã™ã„ãˆã„",tamil:"à®¨à¯€à®šà¯à®šà®²à¯"}], jlpt:"N5", strokes:4, lesson:1 },
  { char:"æœ¨", onyomi:["ãƒ¢ã‚¯","ãƒœã‚¯"], kunyomi:["ã","ã“"], meaning:"Tree / Wood", tamil:"à®®à®°à®®à¯ / à®®à®°à®¤à¯à®¤à®¾à®²à®¾à®©", tamilExp:"à®®à®°à®®à¯ à®…à®²à¯à®²à®¤à¯ à®®à®°à®ªà¯à®ªà¯Šà®°à¯à®Ÿà¯à®•à®³à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"æœ¨æ›œæ—¥",reading:"ã‚‚ãã‚ˆã†ã³",tamil:"à®µà®¿à®¯à®¾à®´à®©à¯"},{word:"æœ¨æ",reading:"ã‚‚ãã–ã„",tamil:"à®®à®°à®•à¯à®•à®Ÿà¯à®Ÿà¯ˆ"}], jlpt:"N5", strokes:4, lesson:1 },
  { char:"é‡‘", onyomi:["ã‚­ãƒ³","ã‚³ãƒ³"], kunyomi:["ã‹ã­","ã‹ãª"], meaning:"Gold / Money / Friday", tamil:"à®¤à®™à¯à®•à®®à¯ / à®ªà®£à®®à¯", tamilExp:"à®¤à®™à¯à®•à®®à¯ à®…à®²à¯à®²à®¤à¯ à®ªà®£à®¤à¯à®¤à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯. à®µà¯†à®³à¯à®³à®¿à®•à¯à®•à®¿à®´à®®à¯ˆà®¯à®¿à®©à¯ à®µà®¾à®°à¯à®¤à¯à®¤à¯ˆà®¯à®¿à®²à¯à®®à¯ à®‰à®³à¯à®³à®¤à¯.", examples:[{word:"é‡‘æ›œæ—¥",reading:"ãã‚“ã‚ˆã†ã³",tamil:"à®µà¯†à®³à¯à®³à®¿"},{word:"ãŠé‡‘",reading:"ãŠã‹ã­",tamil:"à®ªà®£à®®à¯"}], jlpt:"N5", strokes:8, lesson:1 },
  { char:"åœŸ", onyomi:["ãƒ‰","ãƒˆ"], kunyomi:["ã¤ã¡"], meaning:"Earth / Soil / Saturday", tamil:"à®®à®£à¯ / à®ªà¯‚à®®à®¿", tamilExp:"à®®à®£à¯ à®…à®²à¯à®²à®¤à¯ à®ªà¯‚à®®à®¿à®¯à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯. à®šà®©à®¿à®•à¯à®•à®¿à®´à®®à¯ˆà®¯à®¿à®²à¯à®®à¯ à®‡à®¤à¯ à®µà®°à¯à®®à¯.", examples:[{word:"åœŸæ›œæ—¥",reading:"ã©ã‚ˆã†ã³",tamil:"à®šà®©à®¿"},{word:"åœŸåœ°",reading:"ã¨ã¡",tamil:"à®¨à®¿à®²à®®à¯"}], jlpt:"N5", strokes:3, lesson:1 },

  // â”€â”€â”€ LESSON 2: Numbers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  { char:"ä¸€", onyomi:["ã‚¤ãƒ","ã‚¤ãƒ„"], kunyomi:["ã²ã¨(ã¤)"], meaning:"One", tamil:"à®’à®©à¯à®±à¯ (1)", tamilExp:"à®à®£à¯ à®’à®©à¯à®±à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿. à®®à®¿à®• à®à®³à®¿à®®à¯ˆà®¯à®¾à®© à®•à®à¯à®šà®¿.", examples:[{word:"ä¸€ã¤",reading:"ã²ã¨ã¤",tamil:"à®’à®°à¯ à®ªà¯Šà®°à¯à®³à¯"},{word:"ä¸€æœˆ",reading:"ã„ã¡ãŒã¤",tamil:"à®œà®©à®µà®°à®¿"}], jlpt:"N5", strokes:1, lesson:2 },
  { char:"äºŒ", onyomi:["ãƒ‹"], kunyomi:["ãµãŸ(ã¤)"], meaning:"Two", tamil:"à®‡à®°à®£à¯à®Ÿà¯ (2)", tamilExp:"à®à®£à¯ à®‡à®°à®£à¯à®Ÿà¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿.", examples:[{word:"äºŒã¤",reading:"ãµãŸã¤",tamil:"à®‡à®°à®£à¯à®Ÿà¯ à®ªà¯Šà®°à¯à®Ÿà¯à®•à®³à¯"},{word:"äºŒæœˆ",reading:"ã«ãŒã¤",tamil:"à®ªà®¿à®ªà¯à®°à®µà®°à®¿"}], jlpt:"N5", strokes:2, lesson:2 },
  { char:"ä¸‰", onyomi:["ã‚µãƒ³"], kunyomi:["ã¿(ã¤)","ã¿ã£(ã¤)"], meaning:"Three", tamil:"à®®à¯‚à®©à¯à®±à¯ (3)", tamilExp:"à®à®£à¯ à®®à¯‚à®©à¯à®±à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿.", examples:[{word:"ä¸‰ã¤",reading:"ã¿ã£ã¤",tamil:"à®®à¯‚à®©à¯à®±à¯ à®ªà¯Šà®°à¯à®Ÿà¯à®•à®³à¯"},{word:"ä¸‰æœˆ",reading:"ã•ã‚“ãŒã¤",tamil:"à®®à®¾à®°à¯à®šà¯"}], jlpt:"N5", strokes:3, lesson:2 },
  { char:"å››", onyomi:["ã‚·"], kunyomi:["ã‚ˆ(ã¤)","ã‚ˆã‚“"], meaning:"Four", tamil:"à®¨à®¾à®©à¯à®•à¯ (4)", tamilExp:"à®à®£à¯ à®¨à®¾à®©à¯à®•à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯. à®œà®ªà¯à®ªà®¾à®©à®¿à®²à¯ 4 à®à®£à¯à®£à¯ˆ à®šà®¿à®² à®¨à¯‡à®°à®™à¯à®•à®³à®¿à®²à¯ à®¤à®µà®¿à®°à¯à®•à¯à®•à®¿à®±à®¾à®°à¯à®•à®³à¯.", examples:[{word:"å››ã¤",reading:"ã‚ˆã£ã¤",tamil:"à®¨à®¾à®©à¯à®•à¯ à®ªà¯Šà®°à¯à®Ÿà¯à®•à®³à¯"},{word:"å››æœˆ",reading:"ã—ãŒã¤",tamil:"à®à®ªà¯à®°à®²à¯"}], jlpt:"N5", strokes:5, lesson:2 },
  { char:"äº”", onyomi:["ã‚´"], kunyomi:["ã„ã¤(ã¤)"], meaning:"Five", tamil:"à®à®¨à¯à®¤à¯ (5)", tamilExp:"à®à®£à¯ à®à®¨à¯à®¤à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿.", examples:[{word:"äº”ã¤",reading:"ã„ã¤ã¤",tamil:"à®à®¨à¯à®¤à¯ à®ªà¯Šà®°à¯à®Ÿà¯à®•à®³à¯"},{word:"äº”æœˆ",reading:"ã”ãŒã¤",tamil:"à®®à¯‡"}], jlpt:"N5", strokes:4, lesson:2 },
  { char:"ç™¾", onyomi:["ãƒ’ãƒ£ã‚¯"], kunyomi:[], meaning:"Hundred", tamil:"à®¨à¯‚à®±à¯ (100)", tamilExp:"à®¨à¯‚à®±à¯à®±à¯ à®à®©à¯à®± à®à®£à¯à®£à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿.", examples:[{word:"ç™¾å††",reading:"ã²ã‚ƒããˆã‚“",tamil:"100 à®¯à¯†à®©à¯"},{word:"æ•°ç™¾",reading:"ã™ã†ã²ã‚ƒã",tamil:"à®ªà®² à®¨à¯‚à®±à¯"}], jlpt:"N5", strokes:6, lesson:2 },
  { char:"åƒ", onyomi:["ã‚»ãƒ³"], kunyomi:["ã¡"], meaning:"Thousand", tamil:"à®†à®¯à®¿à®°à®®à¯ (1000)", tamilExp:"à®†à®¯à®¿à®°à®®à¯ à®à®©à¯à®± à®à®£à¯à®£à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿.", examples:[{word:"åƒå††",reading:"ã›ã‚“ãˆã‚“",tamil:"1000 à®¯à¯†à®©à¯"},{word:"åƒå¹´",reading:"ã›ã‚“ã­ã‚“",tamil:"à®†à®¯à®¿à®°à®®à¯ à®†à®£à¯à®Ÿà¯à®•à®³à¯"}], jlpt:"N5", strokes:3, lesson:2 },

  // â”€â”€â”€ LESSON 3: People & Directions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  { char:"äºº", onyomi:["ã‚¸ãƒ³","ãƒ‹ãƒ³"], kunyomi:["ã²ã¨"], meaning:"Person / Human", tamil:"à®®à®©à®¿à®¤à®©à¯ / à®¨à®ªà®°à¯", tamilExp:"à®®à®©à®¿à®¤à®©à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯. à®¨à®¿à®±à¯à®•à¯à®®à¯ à®®à®©à®¿à®¤à®©à®¿à®©à¯ à®šà®¿à®²à¯à®µà¯ˆ à®µà®Ÿà®¿à®µà®¿à®²à¯ à®‰à®³à¯à®³à®¤à¯.", examples:[{word:"äººé–“",reading:"ã«ã‚“ã’ã‚“",tamil:"à®®à®©à®¿à®¤ à®‡à®©à®®à¯"},{word:"å¤–å›½äºº",reading:"ãŒã„ã“ãã˜ã‚“",tamil:"à®µà¯†à®³à®¿à®¨à®¾à®Ÿà¯à®Ÿà®¿à®©à®°à¯"}], jlpt:"N5", strokes:2, lesson:3 },
  { char:"å±±", onyomi:["ã‚µãƒ³"], kunyomi:["ã‚„ã¾"], meaning:"Mountain", tamil:"à®®à®²à¯ˆ", tamilExp:"à®®à®²à¯ˆà®¯à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿. à®®à¯‚à®©à¯à®±à¯ à®šà®¿à®•à®°à®™à¯à®•à®³à¯ˆ à®ªà¯‹à®²à¯ à®¤à¯‹à®±à¯à®±à®®à®³à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"å¯Œå£«å±±",reading:"ãµã˜ã•ã‚“",tamil:"à®ƒà®ªà¯à®œà®¿ à®®à®²à¯ˆ"},{word:"å±±é“",reading:"ã‚„ã¾ã¿ã¡",tamil:"à®®à®²à¯ˆ à®µà®´à®¿"}], jlpt:"N5", strokes:3, lesson:3 },
  { char:"å·", onyomi:["ã‚»ãƒ³"], kunyomi:["ã‹ã‚"], meaning:"River", tamil:"à®¨à®¤à®¿ / à®†à®±à¯", tamilExp:"à®¨à®¤à®¿à®¯à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯. à®®à¯‚à®©à¯à®±à¯ à®¨à¯€à®°à¯ à®µà®°à®¿à®•à®³à¯ˆ à®ªà¯‹à®²à¯ à®¤à¯‹à®±à¯à®±à®®à®³à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"å·å²¸",reading:"ã‹ã‚ãã—",tamil:"à®¨à®¤à®¿à®•à¯à®•à®°à¯ˆ"},{word:"å¤§å·",reading:"ãŠãŠã‹ã‚",tamil:"à®ªà¯†à®°à®¿à®¯ à®†à®±à¯"}], jlpt:"N5", strokes:3, lesson:3 },
  { char:"ä¸Š", onyomi:["ã‚¸ãƒ§ã‚¦","ã‚·ãƒ§ã‚¦"], kunyomi:["ã†ãˆ","ã†ã‚","ã‹ã¿"], meaning:"Up / Above / On top", tamil:"à®®à¯‡à®²à¯ / à®®à¯‡à®²à¯‡", tamilExp:"à®®à¯‡à®²à¯ à®¤à®¿à®šà¯ˆà®¯à¯ˆ à®…à®²à¯à®²à®¤à¯ à®’à®©à¯à®±à®¿à®©à¯ à®®à¯‡à®²à¯‡ à®‡à®°à¯à®ªà¯à®ªà®¤à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"ä¸Šæ‰‹",reading:"ã˜ã‚‡ã†ãš",tamil:"à®¤à®¿à®±à®®à¯ˆà®¯à®¾à®©"},{word:"ä¸ŠãŒã‚‹",reading:"ã‚ãŒã‚‹",tamil:"à®®à¯‡à®²à¯‡ à®šà¯†à®²à¯à®µà®¤à¯"}], jlpt:"N5", strokes:3, lesson:3 },
  { char:"ä¸‹", onyomi:["ã‚«","ã‚²"], kunyomi:["ã—ãŸ","ã—ã‚‚","ãã (ã™)"], meaning:"Down / Below / Under", tamil:"à®•à¯€à®´à¯ / à®•à¯€à®´à¯‡", tamilExp:"à®•à¯€à®´à¯ à®¤à®¿à®šà¯ˆà®¯à¯ˆ à®…à®²à¯à®²à®¤à¯ à®’à®©à¯à®±à®¿à®©à¯ à®•à¯€à®´à¯‡ à®‡à®°à¯à®ªà¯à®ªà®¤à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"åœ°ä¸‹",reading:"ã¡ã‹",tamil:"à®¨à®¿à®²à®¤à¯à®¤à®¿à®©à¯ à®•à¯€à®´à¯"},{word:"ä¸‹ãŒã‚‹",reading:"ã•ãŒã‚‹",tamil:"à®•à¯€à®´à¯‡ à®šà¯†à®²à¯à®µà®¤à¯"}], jlpt:"N5", strokes:3, lesson:3 },
  { char:"å¤§", onyomi:["ãƒ€ã‚¤","ã‚¿ã‚¤"], kunyomi:["ãŠãŠ(ãã„)"], meaning:"Big / Large / Great", tamil:"à®ªà¯†à®°à®¿à®¯ / à®ªà¯†à®°à®¿à®¤à¯", tamilExp:"à®ªà¯†à®°à®¿à®¯ à®…à®²à¯à®²à®¤à¯ à®ªà®¿à®°à®®à®¾à®£à¯à®Ÿà®®à®¾à®© à®à®©à¯à®±à¯ à®ªà¯Šà®°à¯à®³à¯ à®¤à®°à¯à®®à¯.", examples:[{word:"å¤§å­¦",reading:"ã ã„ãŒã",tamil:"à®ªà®²à¯à®•à®²à¯ˆà®•à¯à®•à®´à®•à®®à¯"},{word:"å¤§åˆ‡",reading:"ãŸã„ã›ã¤",tamil:"à®®à¯à®•à¯à®•à®¿à®¯à®®à®¾à®©"}], jlpt:"N5", strokes:3, lesson:3 },
  { char:"å°", onyomi:["ã‚·ãƒ§ã‚¦"], kunyomi:["ã¡ã„(ã•ã„)","ã“","ãŠ"], meaning:"Small / Little", tamil:"à®šà®¿à®±à®¿à®¯ / à®šà®¿à®©à¯à®©", tamilExp:"à®šà®¿à®±à®¿à®¯ à®…à®²à¯à®²à®¤à¯ à®•à¯à®±à¯ˆà®µà®¾à®© à®à®©à¯à®±à¯ à®ªà¯Šà®°à¯à®³à¯ à®¤à®°à¯à®®à¯.", examples:[{word:"å°å­¦æ ¡",reading:"ã—ã‚‡ã†ãŒã£ã“ã†",tamil:"à®¤à¯Šà®Ÿà®•à¯à®•à®ªà¯à®ªà®³à¯à®³à®¿"},{word:"å°ã•ã„",reading:"ã¡ã„ã•ã„",tamil:"à®šà®¿à®±à®¿à®¯à®¤à¯"}], jlpt:"N5", strokes:3, lesson:3 },

  // â”€â”€â”€ LESSON 4: Nature & Time â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  { char:"å¹´", onyomi:["ãƒãƒ³"], kunyomi:["ã¨ã—"], meaning:"Year", tamil:"à®†à®£à¯à®Ÿà¯ / à®µà®°à¯à®Ÿà®®à¯", tamilExp:"à®’à®°à¯ à®µà®°à¯à®Ÿà®¤à¯à®¤à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿.", examples:[{word:"ä»Šå¹´",reading:"ã“ã¨ã—",tamil:"à®‡à®¨à¯à®¤ à®µà®°à¯à®Ÿà®®à¯"},{word:"æ¥å¹´",reading:"ã‚‰ã„ã­ã‚“",tamil:"à®…à®Ÿà¯à®¤à¯à®¤ à®µà®°à¯à®Ÿà®®à¯"}], jlpt:"N5", strokes:6, lesson:4 },
  { char:"æ™‚", onyomi:["ã‚¸"], kunyomi:["ã¨ã"], meaning:"Time / Hour / Occasion", tamil:"à®¨à¯‡à®°à®®à¯ / à®®à®£à®¿", tamilExp:"à®¨à¯‡à®°à®®à¯ à®…à®²à¯à®²à®¤à¯ à®’à®°à¯ à®•à¯à®±à®¿à®ªà¯à®ªà®¿à®Ÿà¯à®Ÿ à®¨à¯‡à®°à®¤à¯à®¤à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"æ™‚é–“",reading:"ã˜ã‹ã‚“",tamil:"à®¨à¯‡à®°à®®à¯ (duration)"},{word:"ä½•æ™‚",reading:"ãªã‚“ã˜",tamil:"à®à®¤à¯à®¤à®©à¯ˆ à®®à®£à®¿?"}], jlpt:"N5", strokes:10, lesson:4 },
  { char:"åˆ†", onyomi:["ãƒ–ãƒ³","ãƒ•ãƒ³"], kunyomi:["ã‚(ã‹ã‚‹)","ã‚(ã‘ã‚‹)"], meaning:"Minute / Part / Understand", tamil:"à®¨à®¿à®®à®¿à®Ÿà®®à¯ / à®ªà®•à¯à®¤à®¿ / à®ªà¯à®°à®¿à®¤à®²à¯", tamilExp:"à®¨à®¿à®®à®¿à®Ÿà®®à¯, à®ªà®•à¯à®ªà¯à®ªà¯ à®…à®²à¯à®²à®¤à¯ à®ªà¯à®°à®¿à®¨à¯à®¤à¯à®•à¯Šà®³à¯à®µà®¤à¯ à®à®©à¯à®±à¯ à®ªà®² à®ªà¯Šà®°à¯à®³à¯ à®¤à®°à¯à®®à¯.", examples:[{word:"äº”åˆ†",reading:"ã”ãµã‚“",tamil:"à®à®¨à¯à®¤à¯ à®¨à®¿à®®à®¿à®Ÿà®™à¯à®•à®³à¯"},{word:"åˆ†ã‹ã‚‹",reading:"ã‚ã‹ã‚‹",tamil:"à®ªà¯à®°à®¿à®•à®¿à®±à®¤à¯"}], jlpt:"N5", strokes:4, lesson:4 },
  { char:"ä»Š", onyomi:["ã‚³ãƒ³","ã‚­ãƒ³"], kunyomi:["ã„ã¾"], meaning:"Now / Present", tamil:"à®‡à®ªà¯à®ªà¯‹à®¤à¯ / à®¤à®±à¯à®ªà¯‹à®¤à¯", tamilExp:"à®‡à®ªà¯à®ªà¯‹à®¤à¯ à®…à®²à¯à®²à®¤à¯ à®¤à®±à¯à®ªà¯‹à®¤à¯ˆà®¯ à®à®©à¯à®±à¯ à®ªà¯Šà®°à¯à®³à¯ à®¤à®°à¯à®®à¯.", examples:[{word:"ä»Šæ—¥",reading:"ãã‚‡ã†",tamil:"à®‡à®©à¯à®±à¯"},{word:"ä»Šé€±",reading:"ã“ã‚“ã—ã‚…ã†",tamil:"à®‡à®¨à¯à®¤ à®µà®¾à®°à®®à¯"}], jlpt:"N5", strokes:4, lesson:4 },
  { char:"å…ˆ", onyomi:["ã‚»ãƒ³"], kunyomi:["ã•ã","ã¾(ãš)"], meaning:"Ahead / Previous / First", tamil:"à®®à¯à®©à¯à®©à®¾à®²à¯ / à®®à¯à®¤à®²à®¿à®²à¯", tamilExp:"à®®à¯à®©à¯à®©à®¾à®²à¯ à®…à®²à¯à®²à®¤à¯ à®®à¯à®©à¯à®ªà¯ à®à®©à¯à®±à¯ à®ªà¯Šà®°à¯à®³à¯ à®¤à®°à¯à®®à¯.", examples:[{word:"å…ˆç”Ÿ",reading:"ã›ã‚“ã›ã„",tamil:"à®†à®šà®¿à®°à®¿à®¯à®°à¯"},{word:"å…ˆé€±",reading:"ã›ã‚“ã—ã‚…ã†",tamil:"à®•à®Ÿà®¨à¯à®¤ à®µà®¾à®°à®®à¯"}], jlpt:"N5", strokes:6, lesson:4 },

  // â”€â”€â”€ LESSON 5: School & Study â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  { char:"å­¦", onyomi:["ã‚¬ã‚¯"], kunyomi:["ã¾ãª(ã¶)"], meaning:"Study / Learn / School", tamil:"à®ªà®Ÿà®¿à®¤à¯à®¤à®²à¯ / à®•à®±à¯à®±à®²à¯ / à®ªà®³à¯à®³à®¿", tamilExp:"à®ªà®Ÿà®¿à®ªà¯à®ªà¯ à®…à®²à¯à®²à®¤à¯ à®•à®±à¯à®±à®²à¯ à®à®©à¯à®±à¯ à®ªà¯Šà®°à¯à®³à¯ à®¤à®°à¯à®®à¯.", examples:[{word:"å¤§å­¦",reading:"ã ã„ãŒã",tamil:"à®ªà®²à¯à®•à®²à¯ˆà®•à¯à®•à®´à®•à®®à¯"},{word:"å­¦ç”Ÿ",reading:"ãŒãã›ã„",tamil:"à®®à®¾à®£à®µà®°à¯"}], jlpt:"N5", strokes:8, lesson:5 },
  { char:"æ ¡", onyomi:["ã‚³ã‚¦"], kunyomi:[], meaning:"School", tamil:"à®ªà®³à¯à®³à®¿ / à®•à®²à¯à®µà®¿ à®¨à®¿à®±à¯à®µà®©à®®à¯", tamilExp:"à®ªà®³à¯à®³à®¿ à®…à®²à¯à®²à®¤à¯ à®•à®²à¯à®µà®¿ à®¨à®¿à®±à¯à®µà®©à®¤à¯à®¤à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"å­¦æ ¡",reading:"ãŒã£ã“ã†",tamil:"à®ªà®³à¯à®³à®¿"},{word:"é«˜æ ¡",reading:"ã“ã†ã“ã†",tamil:"à®‰à®¯à®°à¯à®¨à®¿à®²à¯ˆà®ªà¯ à®ªà®³à¯à®³à®¿"}], jlpt:"N5", strokes:10, lesson:5 },
  { char:"ç”Ÿ", onyomi:["ã‚»ã‚¤","ã‚·ãƒ§ã‚¦"], kunyomi:["ã„(ãã‚‹)","ã†(ã¾ã‚Œã‚‹)","ãªã¾"], meaning:"Life / Birth / Live / Raw", tamil:"à®µà®¾à®´à¯à®•à¯à®•à¯ˆ / à®ªà®¿à®±à®ªà¯à®ªà¯ / à®•à®šà¯à®šà®¾à®®à®¾à®©", tamilExp:"à®µà®¾à®´à¯à®•à¯à®•à¯ˆ, à®ªà®¿à®±à®ªà¯à®ªà¯ à®…à®²à¯à®²à®¤à¯ à®•à®šà¯à®šà®¾ à®à®©à¯à®±à¯ à®ªà®² à®ªà¯Šà®°à¯à®³à¯.", examples:[{word:"å­¦ç”Ÿ",reading:"ãŒãã›ã„",tamil:"à®®à®¾à®£à®µà®°à¯"},{word:"èª•ç”Ÿæ—¥",reading:"ãŸã‚“ã˜ã‚‡ã†ã³",tamil:"à®ªà®¿à®±à®¨à¯à®¤à®¨à®¾à®³à¯"}], jlpt:"N5", strokes:5, lesson:5 },
  { char:"èª", onyomi:["ã‚´"], kunyomi:["ã‹ãŸ(ã‚‹)","ã‹ãŸ(ã‚‰ã†)"], meaning:"Language / Word / Story", tamil:"à®®à¯Šà®´à®¿ / à®µà®¾à®°à¯à®¤à¯à®¤à¯ˆ / à®•à®¤à¯ˆ", tamilExp:"à®®à¯Šà®´à®¿ à®…à®²à¯à®²à®¤à¯ à®µà®¾à®°à¯à®¤à¯à®¤à¯ˆà®¯à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯. à®œà®ªà¯à®ªà®¾à®©à®¿à®¯ à®®à¯Šà®´à®¿à®¯à®¿à®²à¯ 'à®®à¯Šà®´à®¿' à®à®©à¯à®±à¯ à®šà¯Šà®²à¯à®² 'èª' à®ªà®¯à®©à¯à®ªà®Ÿà¯à®¤à¯à®¤à®ªà¯à®ªà®Ÿà¯à®®à¯.", examples:[{word:"æ—¥æœ¬èª",reading:"ã«ã»ã‚“ã”",tamil:"à®œà®ªà¯à®ªà®¾à®©à®¿à®¯ à®®à¯Šà®´à®¿"},{word:"è‹±èª",reading:"ãˆã„ã”",tamil:"à®†à®™à¯à®•à®¿à®²à®®à¯"}], jlpt:"N5", strokes:14, lesson:5 },
  { char:"èª­", onyomi:["ãƒ‰ã‚¯","ãƒˆã‚¯"], kunyomi:["ã‚ˆ(ã‚€)"], meaning:"Read", tamil:"à®ªà®Ÿà®¿à®•à¯à®•à®µà®¤à¯ / à®µà®¾à®šà®¿à®ªà¯à®ªà®¤à¯", tamilExp:"à®ªà®Ÿà®¿à®ªà¯à®ªà®¤à¯ à®…à®²à¯à®²à®¤à¯ à®µà®¾à®šà®¿à®ªà¯à®ªà®¤à¯ à®à®©à¯à®±à¯ à®ªà¯Šà®°à¯à®³à¯.", examples:[{word:"èª­æ›¸",reading:"ã©ãã—ã‚‡",tamil:"à®ªà¯à®¤à¯à®¤à®• à®µà®¾à®šà®¿à®ªà¯à®ªà¯"},{word:"èª­ã‚€",reading:"ã‚ˆã‚€",tamil:"à®ªà®Ÿà®¿à®•à¯à®•à®¿à®±à¯‡à®©à¯"}], jlpt:"N5", strokes:14, lesson:5 },
  { char:"æ›¸", onyomi:["ã‚·ãƒ§"], kunyomi:["ã‹(ã)"], meaning:"Write / Book", tamil:"à®à®´à¯à®¤à¯à®µà®¤à¯ / à®ªà¯à®¤à¯à®¤à®•à®®à¯", tamilExp:"à®à®´à¯à®¤à¯à®µà®¤à¯ à®…à®²à¯à®²à®¤à¯ à®ªà¯à®¤à¯à®¤à®•à®¤à¯à®¤à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"æ•™ç§‘æ›¸",reading:"ãã‚‡ã†ã‹ã—ã‚‡",tamil:"à®ªà®¾à®Ÿà®ªà¯à®ªà¯à®¤à¯à®¤à®•à®®à¯"},{word:"æ›¸ã",reading:"ã‹ã",tamil:"à®à®´à¯à®•à®¿à®±à¯‡à®©à¯"}], jlpt:"N5", strokes:10, lesson:5 },

  // â”€â”€â”€ LESSON 6: Family â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  { char:"çˆ¶", onyomi:["ãƒ•"], kunyomi:["ã¡ã¡"], meaning:"Father", tamil:"à®¤à®¨à¯à®¤à¯ˆ / à®…à®ªà¯à®ªà®¾", tamilExp:"à®¤à®¨à¯à®¤à¯ˆà®¯à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿. à®šà¯Šà®¨à¯à®¤à®®à®¾à®© à®¤à®¨à¯à®¤à¯ˆà®•à¯à®•à¯ 'ã¡ã¡' à®ªà®¯à®©à¯à®ªà®Ÿà¯à®¤à¯à®¤à¯à®µà¯‹à®®à¯.", examples:[{word:"çˆ¶è¦ª",reading:"ã¡ã¡ãŠã‚„",tamil:"à®¤à®¨à¯à®¤à¯ˆ"},{word:"ãŠçˆ¶ã•ã‚“",reading:"ãŠã¨ã†ã•ã‚“",tamil:"à®…à®ªà¯à®ªà®¾ (à®®à®°à®¿à®¯à®¾à®¤à¯ˆ)"}], jlpt:"N5", strokes:4, lesson:6 },
  { char:"æ¯", onyomi:["ãƒœ"], kunyomi:["ã¯ã¯"], meaning:"Mother", tamil:"à®¤à®¾à®¯à¯ / à®…à®®à¯à®®à®¾", tamilExp:"à®¤à®¾à®¯à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿. 'ã¯ã¯' à®šà¯Šà®¨à¯à®¤à®¤à¯ à®¤à®¾à®¯à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"æ¯è¦ª",reading:"ã¯ã¯ãŠã‚„",tamil:"à®¤à®¾à®¯à¯"},{word:"ãŠæ¯ã•ã‚“",reading:"ãŠã‹ã‚ã•ã‚“",tamil:"à®…à®®à¯à®®à®¾ (à®®à®°à®¿à®¯à®¾à®¤à¯ˆ)"}], jlpt:"N5", strokes:5, lesson:6 },
  { char:"å­", onyomi:["ã‚·","ã‚¹"], kunyomi:["ã“","ã­"], meaning:"Child / Son", tamil:"à®•à¯à®´à®¨à¯à®¤à¯ˆ / à®®à®•à®©à¯", tamilExp:"à®•à¯à®´à®¨à¯à®¤à¯ˆ à®…à®²à¯à®²à®¤à¯ à®®à®•à®©à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿.", examples:[{word:"å­ä¾›",reading:"ã“ã©ã‚‚",tamil:"à®•à¯à®´à®¨à¯à®¤à¯ˆ"},{word:"ç”·ã®å­",reading:"ãŠã¨ã“ã®ã“",tamil:"à®†à®£à¯ à®•à¯à®´à®¨à¯à®¤à¯ˆ"}], jlpt:"N5", strokes:3, lesson:6 },
  { char:"å¥³", onyomi:["ã‚¸ãƒ§","ãƒ‹ãƒ§"], kunyomi:["ãŠã‚“ãª","ã‚"], meaning:"Woman / Female", tamil:"à®ªà¯†à®£à¯ / à®ªà¯†à®£à¯à®®à¯ˆ", tamilExp:"à®ªà¯†à®£à¯à®£à¯ˆ à®…à®²à¯à®²à®¤à¯ à®ªà¯†à®£à¯ à®¤à®©à¯à®®à¯ˆà®¯à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"å¥³æ€§",reading:"ã˜ã‚‡ã›ã„",tamil:"à®ªà¯†à®£à¯"},{word:"å¥³ã®å­",reading:"ãŠã‚“ãªã®ã“",tamil:"à®ªà¯†à®£à¯ à®•à¯à®´à®¨à¯à®¤à¯ˆ"}], jlpt:"N5", strokes:3, lesson:6 },
  { char:"ç”·", onyomi:["ãƒ€ãƒ³","ãƒŠãƒ³"], kunyomi:["ãŠã¨ã“"], meaning:"Man / Male", tamil:"à®†à®£à¯ / à®†à®£à¯à®®à¯ˆ", tamilExp:"à®†à®£à¯ˆ à®…à®²à¯à®²à®¤à¯ à®†à®£à¯ à®¤à®©à¯à®®à¯ˆà®¯à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"ç”·æ€§",reading:"ã ã‚“ã›ã„",tamil:"à®†à®£à¯"},{word:"ç”·ã®å­",reading:"ãŠã¨ã“ã®ã“",tamil:"à®†à®£à¯ à®•à¯à®´à®¨à¯à®¤à¯ˆ"}], jlpt:"N5", strokes:7, lesson:6 },

  // â”€â”€â”€ LESSON 7: Common Verbs & Actions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  { char:"é£Ÿ", onyomi:["ã‚·ãƒ§ã‚¯","ã‚¸ã‚­"], kunyomi:["ãŸ(ã¹ã‚‹)","ã(ã†)"], meaning:"Eat / Food", tamil:"à®šà®¾à®ªà¯à®ªà®¿à®Ÿà¯à®µà®¤à¯ / à®‰à®£à®µà¯", tamilExp:"à®šà®¾à®ªà¯à®ªà®¿à®Ÿà¯à®µà®¤à¯ à®…à®²à¯à®²à®¤à¯ à®‰à®£à®µà¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿.", examples:[{word:"é£Ÿäº‹",reading:"ã—ã‚‡ãã˜",tamil:"à®‰à®£à®µà¯ à®¨à¯‡à®°à®®à¯"},{word:"é£Ÿã¹ã‚‹",reading:"ãŸã¹ã‚‹",tamil:"à®šà®¾à®ªà¯à®ªà®¿à®Ÿà¯à®•à®¿à®±à¯‡à®©à¯"}], jlpt:"N5", strokes:9, lesson:7 },
  { char:"é£²", onyomi:["ã‚¤ãƒ³"], kunyomi:["ã®(ã‚€)"], meaning:"Drink", tamil:"à®•à¯à®Ÿà®¿à®ªà¯à®ªà®¤à¯ / à®ªà®°à¯à®•à¯à®µà®¤à¯", tamilExp:"à®¤à®¿à®°à®µà®¤à¯à®¤à¯ˆ à®•à¯à®Ÿà®¿à®ªà¯à®ªà®¤à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯ à®•à®à¯à®šà®¿.", examples:[{word:"é£²ã¿ç‰©",reading:"ã®ã¿ã‚‚ã®",tamil:"à®ªà®¾à®©à®®à¯"},{word:"é£²ã‚€",reading:"ã®ã‚€",tamil:"à®•à¯à®Ÿà®¿à®•à¯à®•à®¿à®±à¯‡à®©à¯"}], jlpt:"N5", strokes:12, lesson:7 },
  { char:"è¦‹", onyomi:["ã‚±ãƒ³"], kunyomi:["ã¿(ã‚‹)","ã¿(ã›ã‚‹)","ã¿(ãˆã‚‹)"], meaning:"See / Look / Watch", tamil:"à®ªà®¾à®°à¯à®ªà¯à®ªà®¤à¯ / à®ªà®¾à®°à¯à®•à¯à®•à®µà®¤à¯", tamilExp:"à®ªà®¾à®°à¯à®ªà¯à®ªà®¤à¯, à®•à®µà®©à®¿à®ªà¯à®ªà®¤à¯ à®à®©à¯à®±à¯ à®ªà¯Šà®°à¯à®³à¯ à®¤à®°à¯à®®à¯.", examples:[{word:"è¦‹å­¦",reading:"ã‘ã‚“ãŒã",tamil:"à®•à®£à¯à®£à®¿à®ªà¯à®ªà¯ à®ªà®¯à®£à®®à¯"},{word:"è¦‹ã‚‹",reading:"ã¿ã‚‹",tamil:"à®ªà®¾à®°à¯à®•à¯à®•à®¿à®±à¯‡à®©à¯"}], jlpt:"N5", strokes:7, lesson:7 },
  { char:"è", onyomi:["ãƒ–ãƒ³","ãƒ¢ãƒ³"], kunyomi:["ã(ã)","ã(ã“ãˆã‚‹)"], meaning:"Listen / Hear / Ask", tamil:"à®•à¯‡à®Ÿà¯à®ªà®¤à¯ / à®•à¯‡à®Ÿà¯à®•à®µà®¤à¯", tamilExp:"à®•à¯‡à®Ÿà¯à®ªà®¤à¯, à®•à¯‡à®Ÿà¯à®•à®µà®¤à¯ à®à®©à¯à®±à¯ à®ªà¯Šà®°à¯à®³à¯ à®¤à®°à¯à®®à¯.", examples:[{word:"æ–°è",reading:"ã—ã‚“ã¶ã‚“",tamil:"à®šà¯†à®¯à¯à®¤à®¿à®¤à¯à®¤à®¾à®³à¯"},{word:"èã",reading:"ãã",tamil:"à®•à¯‡à®Ÿà¯à®•à®¿à®±à¯‡à®©à¯"}], jlpt:"N5", strokes:14, lesson:7 },
  { char:"è¡Œ", onyomi:["ã‚³ã‚¦","ã‚®ãƒ§ã‚¦","ã‚¢ãƒ³"], kunyomi:["ã„(ã)","ã‚†(ã)","ãŠã“ãª(ã†)"], meaning:"Go / Conduct", tamil:"à®ªà¯‹à®µà®¤à¯ / à®šà¯†à®²à¯à®µà®¤à¯", tamilExp:"à®ªà¯‹à®µà®¤à¯, à®šà¯†à®²à¯à®µà®¤à¯ à®à®©à¯à®±à¯ à®ªà¯Šà®°à¯à®³à¯ à®¤à®°à¯à®®à¯. à®¨à®Ÿà®¤à¯à®¤à¯à®µà®¤à¯ à®à®©à¯à®±à¯à®®à¯ à®ªà¯Šà®°à¯à®³à¯.", examples:[{word:"éŠ€è¡Œ",reading:"ãã‚“ã“ã†",tamil:"à®µà®™à¯à®•à®¿"},{word:"è¡Œã",reading:"ã„ã",tamil:"à®ªà¯‹à®•à®¿à®±à¯‡à®©à¯"}], jlpt:"N5", strokes:6, lesson:7 },

  // â”€â”€â”€ LESSON 8: N4 Kanji â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  { char:"å›½", onyomi:["ã‚³ã‚¯"], kunyomi:["ãã«"], meaning:"Country / Nation", tamil:"à®¨à®¾à®Ÿà¯ / à®¤à¯‡à®šà®®à¯", tamilExp:"à®¨à®¾à®Ÿà¯ à®…à®²à¯à®²à®¤à¯ à®¨à®¾à®Ÿà¯à®Ÿà¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯. à®šà®¤à¯à®°à®¤à¯à®¤à¯ˆ à®ªà¯‹à®²à¯ à®¤à¯‹à®±à¯à®±à®®à®³à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"å¤–å›½",reading:"ãŒã„ã“ã",tamil:"à®µà¯†à®³à®¿à®¨à®¾à®Ÿà¯"},{word:"å›½èª",reading:"ã“ãã”",tamil:"à®¤à¯‡à®šà®¿à®¯ à®®à¯Šà®´à®¿"}], jlpt:"N4", strokes:8, lesson:8 },
  { char:"è©±", onyomi:["ãƒ¯"], kunyomi:["ã¯ãª(ã™)","ã¯ãªã—"], meaning:"Talk / Story / Speak", tamil:"à®ªà¯‡à®šà¯à®µà®¤à¯ / à®•à®¤à¯ˆ / à®‰à®°à¯ˆà®¯à®¾à®Ÿà®²à¯", tamilExp:"à®ªà¯‡à®šà¯à®µà®¤à¯ à®…à®²à¯à®²à®¤à¯ à®•à®¤à¯ˆ à®šà¯Šà®²à¯à®µà®¤à¯ à®à®©à¯à®±à¯ à®ªà¯Šà®°à¯à®³à¯.", examples:[{word:"é›»è©±",reading:"ã§ã‚“ã‚",tamil:"à®¤à¯Šà®²à¯ˆà®ªà¯‡à®šà®¿"},{word:"è©±ã™",reading:"ã¯ãªã™",tamil:"à®ªà¯‡à®šà¯à®•à®¿à®±à¯‡à®©à¯"}], jlpt:"N5", strokes:13, lesson:8 },
  { char:"é“", onyomi:["ãƒ‰ã‚¦","ãƒˆã‚¦"], kunyomi:["ã¿ã¡"], meaning:"Road / Path / Way", tamil:"à®µà®´à®¿ / à®ªà®¾à®¤à¯ˆ / à®šà®¾à®²à¯ˆ", tamilExp:"à®šà®¾à®²à¯ˆ, à®ªà®¾à®¤à¯ˆ à®…à®²à¯à®²à®¤à¯ à®µà®´à®¿à®®à¯à®±à¯ˆà®¯à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"é“è·¯",reading:"ã©ã†ã‚",tamil:"à®šà®¾à®²à¯ˆ"},{word:"åŒ—æµ·é“",reading:"ã»ã£ã‹ã„ã©ã†",tamil:"à®¹à¯Šà®•à¯à®•à¯ˆà®¤à¯‹"}], jlpt:"N4", strokes:12, lesson:8 },
  { char:"é›»", onyomi:["ãƒ‡ãƒ³"], kunyomi:[], meaning:"Electricity / Electric", tamil:"à®®à®¿à®©à¯à®šà®¾à®°à®®à¯ / à®®à®¿à®©à¯à®©à®²à¯", tamilExp:"à®®à®¿à®©à¯à®šà®¾à®°à®®à¯ à®…à®²à¯à®²à®¤à¯ à®®à®¿à®©à¯à®©à®²à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"é›»è»Š",reading:"ã§ã‚“ã—ã‚ƒ",tamil:"à®®à®¿à®©à¯ à®°à®¯à®¿à®²à¯"},{word:"é›»è©±",reading:"ã§ã‚“ã‚",tamil:"à®¤à¯Šà®²à¯ˆà®ªà¯‡à®šà®¿"}], jlpt:"N4", strokes:13, lesson:8 },
  { char:"è»Š", onyomi:["ã‚·ãƒ£"], kunyomi:["ãã‚‹ã¾"], meaning:"Car / Vehicle / Wheel", tamil:"à®µà®£à¯à®Ÿà®¿ / à®•à®¾à®°à¯ / à®šà®•à¯à®•à®°à®®à¯", tamilExp:"à®µà®£à¯à®Ÿà®¿ à®…à®²à¯à®²à®¤à¯ à®•à®¾à®°à¯à®•à®³à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯. à®šà®•à¯à®•à®°à®¤à¯à®¤à®¿à®©à¯ à®µà®Ÿà®¿à®µà®®à¯ à®•à¯Šà®£à¯à®Ÿà®¤à¯.", examples:[{word:"è‡ªå‹•è»Š",reading:"ã˜ã©ã†ã—ã‚ƒ",tamil:"à®•à®¾à®°à¯"},{word:"é›»è»Š",reading:"ã§ã‚“ã—ã‚ƒ",tamil:"à®®à®¿à®©à¯ à®°à®¯à®¿à®²à¯"}], jlpt:"N5", strokes:7, lesson:8 },
  { char:"é§…", onyomi:["ã‚¨ã‚­"], kunyomi:[], meaning:"Station (train)", tamil:"à®‡à®°à®¯à®¿à®²à¯ à®¨à®¿à®²à¯ˆà®¯à®®à¯", tamilExp:"à®‡à®°à®¯à®¿à®²à¯ à®…à®²à¯à®²à®¤à¯ à®®à¯†à®Ÿà¯à®°à¯‹ à®¨à®¿à®²à¯ˆà®¯à®¤à¯à®¤à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à¯à®®à¯.", examples:[{word:"é§…å‰",reading:"ãˆãã¾ãˆ",tamil:"à®¨à®¿à®²à¯ˆà®¯à®¤à¯à®¤à®¿à®©à¯ à®®à¯à®©à¯"},{word:"æ±äº¬é§…",reading:"ã¨ã†ãã‚‡ã†ãˆã",tamil:"à®Ÿà¯‹à®•à¯à®•à®¿à®¯à¯‹ à®¸à¯à®Ÿà¯‡à®·à®©à¯"}], jlpt:"N5", strokes:14, lesson:8 },
];

// ============================================================
// LESSON MODULES CONFIGURATION
// Add/modify lessons here. Each has an id, name, topic, and
// kanji range (indices into KANJI array)
// ============================================================
const LESSONS = [
  { id:1, name:"à®‡à®¯à®±à¯à®•à¯ˆ à®…à®Ÿà®¿à®ªà¯à®ªà®Ÿà¯ˆà®•à®³à¯", nameEn:"Basic Elements", topic:"Days & Elements", kanjiRange:[0,6], color:"#e8a045" },
  { id:2, name:"à®à®£à¯à®•à®³à¯", nameEn:"Numbers", topic:"Numbers 1-1000", kanjiRange:[7,13], color:"#5b8dee" },
  { id:3, name:"à®®à®•à¯à®•à®³à¯ & à®¤à®¿à®šà¯ˆà®•à®³à¯", nameEn:"People & Directions", topic:"People, Nature, Directions", kanjiRange:[14,20], color:"#4caf7d" },
  { id:4, name:"à®¨à¯‡à®°à®®à¯ & à®•à®¾à®²à®®à¯", nameEn:"Time & Calendar", topic:"Time expressions", kanjiRange:[21,25], color:"#9b6ee8" },
  { id:5, name:"à®ªà®³à¯à®³à®¿ & à®ªà®Ÿà®¿à®ªà¯à®ªà¯", nameEn:"School & Study", topic:"Education vocabulary", kanjiRange:[26,31], color:"#e86ea8" },
  { id:6, name:"à®•à¯à®Ÿà¯à®®à¯à®ªà®®à¯", nameEn:"Family", topic:"Family members", kanjiRange:[32,36], color:"#3dbdb8" },
  { id:7, name:"à®šà¯†à®¯à®²à¯à®•à®³à¯", nameEn:"Common Actions", topic:"Verbs & actions", kanjiRange:[37,41], color:"#e05555" },
  { id:8, name:"N4 à®…à®Ÿà®¿à®ªà¯à®ªà®Ÿà¯ˆà®•à®³à¯", nameEn:"N4 Essentials", topic:"Useful N4 kanji", kanjiRange:[42,47], color:"#f0c070" },
];

// ============================================================
// APP STATE & localStorage
// ============================================================
let state = {
  kanjiStatus: {},    // { charIndex: 'known'|'review'|'difficult' }
  quizScores: {},     // { quizType: bestScore }
  quizCount: 0,
  streak: 0,
  lastStudyDate: null,
  settings: { furigana: false, hint: true, sound: false },
  recentActivity: [],
  lessonProgress: {}, // { lessonId: percent }
};

function loadState() {
  try {
    const s = localStorage.getItem('kanjiMasterState');
    if (s) state = { ...state, ...JSON.parse(s) };
  } catch(e) {}
}

function saveState() {
  try { localStorage.setItem('kanjiMasterState', JSON.stringify(state)); } catch(e) {}
}

function getKanjiStatus(idx) { return state.kanjiStatus[idx] || 'none'; }
function setKanjiStatus(idx, status) {
  state.kanjiStatus[idx] = status;
  updateStreakAndStats();
  saveState();
  updateHeaderStats();
}

function updateStreakAndStats() {
  const today = new Date().toDateString();
  if (state.lastStudyDate !== today) {
    state.streak = (state.lastStudyDate === new Date(Date.now()-86400000).toDateString()) ? state.streak + 1 : 1;
    state.lastStudyDate = today;
  }
}

function addActivity(text) {
  state.recentActivity.unshift({ text, time: Date.now() });
  if (state.recentActivity.length > 20) state.recentActivity.pop();
  saveState();
}

function getStatusCounts() {
  let known = 0, review = 0, diff = 0;
  Object.values(state.kanjiStatus).forEach(s => {
    if (s === 'known') known++;
    else if (s === 'review') review++;
    else if (s === 'difficult') diff++;
  });
  return { known, review, diff };
}

function updateHeaderStats() {
  const { known } = getStatusCounts();
  document.getElementById('h-known').textContent = known;
  document.getElementById('h-streak').textContent = state.streak;
  const s = getStatusCounts();
  const si = id => document.getElementById(id);
  if (si('stat-known')) si('stat-known').textContent = s.known;
  if (si('stat-review')) si('stat-review').textContent = s.review;
  if (si('stat-diff')) si('stat-diff').textContent = s.diff;
}

// ============================================================
// NAVIGATION
// ============================================================
let currentView = 'home';

function navigate(view) {
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('view-' + view).classList.add('active');
  document.querySelector(`[data-view="${view}"]`).classList.add('active');
  currentView = view;
  // Re-render on navigate
  if (view === 'library') renderLibrary();
  if (view === 'progress') renderProgress();
  if (view === 'lessons') renderLessonsList();
  if (view === 'home') renderHome();
  if (view === 'practice') renderWritingSelector();
}

// ============================================================
// HOME RENDERING
// ============================================================
let todayKanjiIndex = 0;

function renderHome() {
  todayKanjiIndex = Math.floor(Date.now() / 86400000) % KANJI.length;
  const k = KANJI[todayKanjiIndex];
  document.getElementById('daily-char').textContent = k.char;
  document.getElementById('daily-meaning').textContent = k.meaning;
  document.getElementById('daily-tamil').textContent = k.tamil;
  document.getElementById('daily-on').textContent = 'éŸ³: ' + (k.onyomi[0] || '-');
  document.getElementById('daily-kun').textContent = 'è¨“: ' + (k.kunyomi[0] || '-');

  const lessonEl = document.getElementById('home-lessons');
  lessonEl.innerHTML = LESSONS.slice(0,4).map(l => {
    const kanjis = KANJI.slice(l.kanjiRange[0], l.kanjiRange[1]+1);
    const prog = calcLessonProgress(l);
    return `<div class="lesson-card" onclick="openLesson(${l.id})" style="border-left:3px solid ${l.color}">
      <div class="lesson-num" style="background:${l.color}22;border-color:${l.color}44;color:${l.color}">${l.id}</div>
      <div class="lesson-info">
        <div class="lesson-name">${l.name}</div>
        <div class="lesson-meta"><span>${l.topic}</span><span>${kanjis.length} kanji</span></div>
        <div class="lesson-progress"><div class="lesson-progress-bar" style="width:${prog}%"></div></div>
      </div>
      <div class="lesson-arrow">â€º</div>
    </div>`;
  }).join('');

  updateHeaderStats();
}

function calcLessonProgress(lesson) {
  const kanjis = KANJI.slice(lesson.kanjiRange[0], lesson.kanjiRange[1]+1);
  const known = kanjis.filter((k,i) => getKanjiStatus(lesson.kanjiRange[0]+i) === 'known').length;
  return Math.round((known/kanjis.length)*100);
}

// ============================================================
// KANJI LIBRARY
// ============================================================
let libFilter = 'all';

function renderLibraryFilters() {
  const filtersEl = document.getElementById('lib-filters');
  const levels = ['all', 'N5', 'N4', 'N3', 'N2', 'N1', 'known', 'review', 'difficult'];
  filtersEl.innerHTML = levels.map(f =>
    `<div class="filter-chip ${libFilter === f ? 'active' : ''}" onclick="setLibFilter('${f}')">${f === 'all' ? 'All' : f}</div>`
  ).join('');
}

function setLibFilter(f) {
  libFilter = f;
  renderLibrary();
}

function renderLibrary() {
  renderLibraryFilters();
  const q = (document.getElementById('lib-search').value || '').toLowerCase();
  let filtered = KANJI.map((k,i) => ({...k, idx:i})).filter((k,i) => {
    if (q) {
      return k.char.includes(q) || k.meaning.toLowerCase().includes(q) || k.tamil.includes(q) ||
        k.onyomi.some(r => r.toLowerCase().includes(q)) || k.kunyomi.some(r => r.includes(q));
    }
    return true;
  }).filter((k,i) => {
    if (libFilter === 'all') return true;
    if (['N5','N4','N3','N2','N1'].includes(libFilter)) return k.jlpt === libFilter;
    if (['known','review','difficult'].includes(libFilter)) return getKanjiStatus(k.idx) === libFilter;
    return true;
  });

  document.getElementById('lib-count').textContent = `${filtered.length} kanji found`;
  document.getElementById('kanji-grid').innerHTML = filtered.map(k =>
    `<div class="kanji-tile status-${getKanjiStatus(k.idx)}" onclick="openKanjiModal(${k.idx})">
      <div class="tile-status-dot"></div>
      <div class="tile-char">${k.char}</div>
      <div class="tile-mean">${k.tamil.split(' / ')[0]}</div>
    </div>`
  ).join('');
}

// ============================================================
// KANJI MODAL
// ============================================================
let currentModalIdx = 0;

function openKanjiModal(idx) {
  currentModalIdx = idx;
  const k = KANJI[idx];
  const status = getKanjiStatus(idx);
  const modal = document.getElementById('modal-content');

  modal.innerHTML = `
    <div class="modal-handle"></div>
    <div class="modal-kanji-display">
      <div class="modal-kanji-top">
        <span class="tag tag-${k.jlpt.toLowerCase()}">${k.jlpt}</span>
        <span style="font-size:0.75rem;color:var(--text3)">${k.strokes} strokes</span>
      </div>
      <span class="modal-kanji-char">${k.char}</span>
      <div class="modal-meaning-en">${k.meaning}</div>
      <div class="modal-meaning-ta">${k.tamil}</div>
      <div class="modal-tamil-exp">${k.tamilExp}</div>
    </div>
    <div class="readings-grid">
      <div class="reading-box">
        <div class="reading-type on-type">éŸ³èª­ã¿ (Onyomi)</div>
        <div class="reading-value">${k.onyomi.length ? k.onyomi.join('ã€') : 'â€”'}</div>
        <div style="font-size:0.65rem;color:var(--text3);margin-top:4px">Chinese-origin reading</div>
      </div>
      <div class="reading-box">
        <div class="reading-type kun-type">è¨“èª­ã¿ (Kunyomi)</div>
        <div class="reading-value">${k.kunyomi.length ? k.kunyomi.join('ã€') : 'â€”'}</div>
        <div style="font-size:0.65rem;color:var(--text3);margin-top:4px">Japanese-origin reading</div>
      </div>
    </div>
    <div class="examples-section">
      <div class="section-title" style="margin-top:0">à®à®Ÿà¯à®¤à¯à®¤à¯à®•à¯à®•à®¾à®Ÿà¯à®Ÿà¯à®•à®³à¯ â€” Examples</div>
      ${k.examples.map(ex => `
        <div class="example-item">
          <div class="example-word"><ruby>${ex.word}<rp>(</rp><rt>${ex.reading}</rt><rp>)</rp></ruby></div>
          <div class="example-reading">${ex.reading}</div>
          <div class="example-tamil">${ex.tamil}</div>
        </div>
      `).join('')}
    </div>
    <div class="section-title" style="margin-top:4px">à®¨à®¿à®²à¯ˆà®¯à¯ˆ à®•à¯à®±à®¿à®•à¯à®•à®µà¯à®®à¯ â€” Mark Status</div>
    <div class="status-buttons">
      <button class="status-btn known ${status==='known'?'active':''}" onclick="setStatusFromModal(${idx},'known')">âœ“ à®¤à¯†à®°à®¿à®¯à¯à®®à¯<br><span style="font-size:0.62rem;opacity:0.8">Known</span></button>
      <button class="status-btn review ${status==='review'?'active':''}" onclick="setStatusFromModal(${idx},'review')">â†» à®®à®±à¯à®ªà®Ÿà®¿à®¯à¯à®®à¯<br><span style="font-size:0.62rem;opacity:0.8">Review</span></button>
      <button class="status-btn difficult ${status==='difficult'?'active':''}" onclick="setStatusFromModal(${idx},'difficult')">âœ• à®•à®Ÿà®¿à®©à®®à¯<br><span style="font-size:0.62rem;opacity:0.8">Difficult</span></button>
    </div>
    <div class="modal-nav">
      <button class="btn btn-ghost" onclick="navigateModal(-1)">â† Prev</button>
      <button class="btn btn-ghost" onclick="closeModal()">Close</button>
      <button class="btn btn-primary" onclick="navigateModal(1)">Next â†’</button>
    </div>
  `;

  document.getElementById('kanji-modal').classList.add('open');
}

function setStatusFromModal(idx, status) {
  setKanjiStatus(idx, status);
  addActivity(`Marked <strong>${KANJI[idx].char}</strong> as ${status}`);
  // Re-render buttons
  document.querySelectorAll('.status-btn').forEach(b => b.classList.remove('active'));
  document.querySelector(`.status-btn.${status}`).classList.add('active');
  showToast(`${KANJI[idx].char} â†’ ${status}`, 'success');
  if (currentView === 'library') renderLibrary();
}

function navigateModal(dir) {
  const newIdx = (currentModalIdx + dir + KANJI.length) % KANJI.length;
  openKanjiModal(newIdx);
}

function closeModal() { document.getElementById('kanji-modal').classList.remove('open'); }

// ============================================================
// LESSONS
// ============================================================
function renderLessonsList() {
  // Show the list, hide detail
  document.getElementById('lessons-list-view').style.display = 'block';
  document.getElementById('lesson-detail-view').style.display = 'none';

  document.getElementById('lessons-list').innerHTML = LESSONS.map(l => {
    const kanjis = KANJI.slice(l.kanjiRange[0], l.kanjiRange[1]+1);
    const prog = calcLessonProgress(l);
    return `<div class="lesson-card" onclick="openLesson(${l.id})" style="border-left:3px solid ${l.color}">
      <div class="lesson-num" style="background:${l.color}22;border-color:${l.color}44;color:${l.color}">${l.id}</div>
      <div class="lesson-info">
        <div class="lesson-name">${l.name} â€” ${l.nameEn}</div>
        <div class="lesson-meta">
          <span>${l.topic}</span>
          <span>${kanjis.length} kanji</span>
          <span class="tag tag-n5" style="font-size:0.58rem">${prog}% done</span>
        </div>
        <div class="lesson-progress"><div class="lesson-progress-bar" style="width:${prog}%"></div></div>
      </div>
      <div class="lesson-arrow">â€º</div>
    </div>`;
  }).join('');
}

let lessonStudyIdx = 0;
let lessonMode = 'study';
let currentLesson = null;

function openLesson(lessonId) {
  navigate('lessons');
  currentLesson = LESSONS.find(l => l.id === lessonId);
  if (!currentLesson) return;
  lessonStudyIdx = 0;
  lessonMode = 'study';
  document.getElementById('lessons-list-view').style.display = 'none';
  document.getElementById('lesson-detail-view').style.display = 'block';
  renderLessonDetail();
}

function renderLessonDetail() {
  const l = currentLesson;
  const kanjis = KANJI.slice(l.kanjiRange[0], l.kanjiRange[1]+1);
  const k = kanjis[lessonStudyIdx];
  const globalIdx = l.kanjiRange[0] + lessonStudyIdx;
  const status = getKanjiStatus(globalIdx);

  const container = document.getElementById('lesson-detail-view');
  container.innerHTML = `
    <button class="btn btn-ghost btn-sm mb-16" onclick="renderLessonsList()">â† Back to Lessons</button>
    <div class="lesson-header" style="border-top:3px solid ${l.color}">
      <div class="lesson-header-title">${l.name}</div>
      <div class="lesson-header-sub">${l.topic} â€¢ ${kanjis.length} kanji</div>
      <div class="lesson-mode-tabs">
        <div class="mode-tab ${lessonMode==='study'?'active':''}" onclick="setLessonMode('study')">ğŸ“– Study</div>
        <div class="mode-tab ${lessonMode==='quiz'?'active':''}" onclick="setLessonMode('quiz')">ğŸ“ Quiz</div>
      </div>
    </div>
    ${lessonMode === 'study' ? renderStudyMode(k, globalIdx, kanjis.length) : ''}
  `;
  if (lessonMode === 'quiz') {
    container.innerHTML += `<div id="lesson-quiz-inline"></div>`;
    startLessonQuiz(kanjis);
  }
}

function setLessonMode(mode) { lessonMode = mode; renderLessonDetail(); }

function renderStudyMode(k, globalIdx, total) {
  return `
    <div class="study-card">
      <div class="study-counter">${lessonStudyIdx+1} / ${total}</div>
      <div class="study-card-kanji">${k.char}</div>
      <div style="display:flex;justify-content:center;gap:8px;margin-bottom:12px;flex-wrap:wrap">
        ${k.onyomi.map(r => `<span class="reading-pill on">éŸ³ ${r}</span>`).join('')}
        ${k.kunyomi.map(r => `<span class="reading-pill kun">è¨“ ${r}</span>`).join('')}
        <span class="tag tag-${k.jlpt.toLowerCase()}">${k.jlpt}</span>
      </div>
      <div class="study-card-meaning">${k.meaning}</div>
      <div class="study-card-tamil">${k.tamil}</div>
      <div style="font-size:0.78rem;color:var(--text2);margin-bottom:12px;font-family:'Noto Sans Tamil',sans-serif;line-height:1.6">${k.tamilExp}</div>
      ${k.examples.map(ex => `
        <div class="example-item" style="text-align:left">
          <div class="example-word"><ruby>${ex.word}<rp>(</rp><rt>${ex.reading}</rt><rp>)</rp></ruby></div>
          <div class="example-tamil">${ex.tamil}</div>
        </div>
      `).join('')}
    </div>
    <div style="display:flex;justify-content:center;gap:8px;margin-bottom:12px;flex-wrap:wrap">
      <button class="btn btn-sm" style="background:rgba(76,175,125,0.2);color:var(--green);border:1px solid rgba(76,175,125,0.3)" onclick="setKanjiStatus(${globalIdx},'known');nextStudy()">âœ“ Known</button>
      <button class="btn btn-sm btn-ghost" onclick="setKanjiStatus(${globalIdx},'review')">â†» Review</button>
      <button class="btn btn-sm" style="background:rgba(224,85,85,0.2);color:var(--red);border:1px solid rgba(224,85,85,0.3)" onclick="setKanjiStatus(${globalIdx},'difficult')">âœ• Hard</button>
    </div>
    <div class="study-nav">
      ${lessonStudyIdx>0 ? '<button class="btn btn-ghost btn-sm" onclick="prevStudy()">â† Prev</button>' : ''}
      <button class="btn btn-primary btn-sm" onclick="nextStudy()">Next â†’</button>
    </div>
  `;
}

function nextStudy() {
  const l = currentLesson;
  const kanjis = KANJI.slice(l.kanjiRange[0], l.kanjiRange[1]+1);
  if (lessonStudyIdx < kanjis.length - 1) { lessonStudyIdx++; renderLessonDetail(); }
  else { showToast('ğŸ‰ Lesson complete!', 'success'); addActivity(`Completed lesson: <strong>${l.name}</strong>`); saveState(); }
}
function prevStudy() { if (lessonStudyIdx > 0) { lessonStudyIdx--; renderLessonDetail(); } }

function startLessonQuiz(kanjis) {
  // Simple inline quiz for the lesson
  let qi = 0, score = 0;
  const container = document.getElementById('lesson-quiz-inline');
  function showQ() {
    if (qi >= Math.min(kanjis.length, 5)) {
      container.innerHTML = `<div class="card text-center"><div style="font-size:2rem">ğŸŠ</div><div style="font-size:1.1rem;font-weight:800;margin:8px 0">Score: ${score}/${Math.min(kanjis.length,5)}</div><button class="btn btn-primary btn-sm" onclick="setLessonMode('study')">Back to Study</button></div>`;
      return;
    }
    const k = kanjis[qi];
    const wrong = KANJI.filter(x => x.char !== k.char).sort(() => Math.random()-0.5).slice(0,3);
    const opts = [...wrong.map(x => x.tamil), k.tamil].sort(() => Math.random()-0.5);
    container.innerHTML = `
      <div class="card" style="text-align:center;padding:24px">
        <div style="font-size:0.7rem;color:var(--text3);margin-bottom:8px">Question ${qi+1}/${Math.min(kanjis.length,5)}</div>
        <div style="font-family:'Noto Serif JP';font-size:4rem;color:var(--accent2)">${k.char}</div>
        <div style="font-size:0.78rem;color:var(--text3);margin:8px 0">à®‡à®¨à¯à®¤ à®•à®à¯à®šà®¿à®¯à®¿à®©à¯ à®¤à®®à®¿à®´à¯ à®ªà¯Šà®°à¯à®³à¯ à®à®©à¯à®©?</div>
      </div>
      <div class="quiz-options" style="margin-bottom:12px">
        ${opts.map(opt => `<button class="quiz-option" onclick="answerLQ(this,'${opt.replace(/'/g,"\\'")}','${k.tamil.replace(/'/g,"\\'")}',${qi})">${opt}</button>`).join('')}
      </div>
    `;
  }
  window.answerLQ = (btn, chosen, correct, qIdx) => {
    document.querySelectorAll('.quiz-option').forEach(b => b.classList.add('disabled'));
    if (chosen === correct) { btn.classList.add('correct'); score++; showToast('âœ“ à®šà®°à®¿!', 'success'); }
    else {
      btn.classList.add('wrong');
      document.querySelectorAll('.quiz-option').forEach(b => { if (b.textContent.trim() === correct) b.classList.add('correct'); });
      showToast('âœ— à®¤à®µà®±à¯!', 'error');
    }
    setTimeout(() => { qi++; showQ(); }, 1000);
  };
  showQ();
}

// ============================================================
// GAMES / QUIZ
// ============================================================
let quizState = { type:null, questions:[], qi:0, score:0, streak:0 };

function startQuiz(type) {
  navigate('games');
  document.getElementById('game-select-area').style.display = 'none';
  document.querySelectorAll('.quiz-area').forEach(a => { a.classList.remove('active'); a.innerHTML = ''; });

  const areaId = `quiz-${type}-area`;
  document.getElementById(areaId).classList.add('active');

  quizState = { type, questions: generateQuizQuestions(type), qi:0, score:0, streak:0 };
  if (type === 'mcq') renderMCQ();
  else if (type === 'reading') renderReadingQuiz();
  else if (type === 'match') renderMatchGame();
  else if (type === 'flashcard') renderFlashcards();
}

function generateQuizQuestions(type) {
  const shuffled = [...KANJI].sort(() => Math.random()-0.5).slice(0, type==='match' ? 6 : 10);
  return shuffled;
}

function quizBackToMenu() {
  document.getElementById('game-select-area').style.display = 'block';
  document.querySelectorAll('.quiz-area').forEach(a => { a.classList.remove('active'); a.innerHTML = ''; });
  renderBestScores();
}

function renderMCQ() {
  const area = document.getElementById('quiz-mcq-area');
  const { questions, qi, score } = quizState;
  if (qi >= questions.length) { showScorePopup(score, questions.length, 'mcq'); return; }

  const k = questions[qi];
  const wrong = KANJI.filter(x => x.char !== k.char).sort(() => Math.random()-0.5).slice(0,3);
  const opts = [...wrong.map(x => x.tamil), k.tamil].sort(() => Math.random()-0.5);
  const pct = Math.round((qi/questions.length)*100);

  area.innerHTML = `
    <div class="quiz-header">
      <button class="quiz-back" onclick="quizBackToMenu()">â†</button>
      <div class="quiz-title">ğŸ¯ à®…à®°à¯à®¤à¯à®¤ à®µà®¿à®©à®¾ â€” Meaning Quiz</div>
      <div class="quiz-score">${score}/${qi}</div>
    </div>
    <div class="quiz-progress-bar"><div class="quiz-progress-fill" style="width:${pct}%"></div></div>
    <div class="quiz-question-card">
      <div class="quiz-q-label">à®‡à®¨à¯à®¤ à®•à®à¯à®šà®¿à®¯à®¿à®©à¯ à®¤à®®à®¿à®´à¯ à®ªà¯Šà®°à¯à®³à¯ à®à®©à¯à®©?</div>
      <div class="quiz-q-kanji">${k.char}</div>
      <div class="quiz-q-hint">${k.jlpt} â€¢ ${k.strokes} strokes</div>
    </div>
    <div class="quiz-options">
      ${opts.map(opt => `<button class="quiz-option" onclick="answerMCQ(this,'${opt.replace(/'/g,"\\'")}','${k.tamil.replace(/'/g,"\\'")}')">${opt}</button>`).join('')}
    </div>
    <div class="quiz-feedback" id="q-feedback"></div>
  `;
}

function answerMCQ(btn, chosen, correct) {
  document.querySelectorAll('.quiz-option').forEach(b => b.classList.add('disabled'));
  const fb = document.getElementById('q-feedback');
  if (chosen === correct) {
    btn.classList.add('correct');
    quizState.score++; quizState.streak++;
    fb.textContent = `âœ“ à®šà®°à®¿! ${quizState.streak > 2 ? 'ğŸ”¥ '+quizState.streak+' streak!' : ''}`;
    fb.className = 'quiz-feedback show correct-fb';
  } else {
    btn.classList.add('wrong');
    document.querySelectorAll('.quiz-option').forEach(b => { if(b.textContent.trim()===correct) b.classList.add('correct'); });
    quizState.streak = 0;
    fb.textContent = `âœ— à®¤à®µà®±à¯! à®šà®°à®¿à®¯à®¾à®© à®µà®¿à®Ÿà¯ˆ: ${correct}`;
    fb.className = 'quiz-feedback show wrong-fb';
  }
  quizState.qi++;
  setTimeout(renderMCQ, 1400);
}

function renderReadingQuiz() {
  const area = document.getElementById('quiz-reading-area');
  const { questions, qi, score } = quizState;
  if (qi >= questions.length) { showScorePopup(score, questions.length, 'reading'); return; }

  const k = questions[qi];
  const correctReading = k.onyomi[0] || k.kunyomi[0] || 'â€”';
  const wrong = KANJI.filter(x => x.char !== k.char && (x.onyomi[0] || x.kunyomi[0]))
    .sort(() => Math.random()-0.5).slice(0,3)
    .map(x => x.onyomi[0] || x.kunyomi[0]);
  const opts = [...wrong, correctReading].sort(() => Math.random()-0.5);
  const pct = Math.round((qi/questions.length)*100);

  area.innerHTML = `
    <div class="quiz-header">
      <button class="quiz-back" onclick="quizBackToMenu()">â†</button>
      <div class="quiz-title">ğŸ“– à®ªà®Ÿà®¿à®ªà¯à®ªà¯ à®µà®¿à®©à®¾ â€” Reading Quiz</div>
      <div class="quiz-score">${score}/${qi}</div>
    </div>
    <div class="quiz-progress-bar"><div class="quiz-progress-fill" style="width:${pct}%"></div></div>
    <div class="quiz-question-card">
      <div class="quiz-q-label">à®‡à®¨à¯à®¤ à®•à®à¯à®šà®¿à®¯à®¿à®©à¯ éŸ³èª­ã¿ (onyomi) à®à®©à¯à®©?</div>
      <div class="quiz-q-kanji">${k.char}</div>
      <div class="quiz-q-hint">${k.meaning}</div>
    </div>
    <div class="quiz-options">
      ${opts.map(opt => `<button class="quiz-option font-jp" onclick="answerReading(this,'${opt}','${correctReading}')">${opt}</button>`).join('')}
    </div>
    <div class="quiz-feedback" id="q-feedback-r"></div>
  `;
}

function answerReading(btn, chosen, correct) {
  document.querySelectorAll('.quiz-option').forEach(b => b.classList.add('disabled'));
  const fb = document.getElementById('q-feedback-r');
  if (chosen === correct) {
    btn.classList.add('correct'); quizState.score++;
    fb.textContent = 'âœ“ à®šà®°à®¿!'; fb.className = 'quiz-feedback show correct-fb';
  } else {
    btn.classList.add('wrong');
    document.querySelectorAll('.quiz-option').forEach(b => { if(b.textContent.trim()===correct) b.classList.add('correct'); });
    fb.textContent = `âœ— à®¤à®µà®±à¯! ${correct}`; fb.className = 'quiz-feedback show wrong-fb';
  }
  quizState.qi++;
  setTimeout(renderReadingQuiz, 1400);
}

function renderMatchGame() {
  const area = document.getElementById('quiz-match-area');
  const qs = quizState.questions;
  let selected = null, matched = new Set(), errors = 0;
  const kanjis = qs.map((k,i) => ({id:'k'+i, type:'kanji', val:k.char, pair:i}));
  const meanings = qs.map((k,i) => ({id:'m'+i, type:'meaning', val:k.tamil.split(' / ')[0], pair:i}));
  const items = [...kanjis, ...meanings].sort(() => Math.random()-0.5);

  function render() {
    area.innerHTML = `
      <div class="quiz-header">
        <button class="quiz-back" onclick="quizBackToMenu()">â†</button>
        <div class="quiz-title">ğŸ”— à®ªà¯Šà®°à¯à®¤à¯à®¤à®®à¯ â€” Match Game</div>
        <div class="quiz-score">${matched.size/2}/${qs.length} pairs</div>
      </div>
      <div style="font-size:0.75rem;color:var(--text2);margin-bottom:12px;text-align:center">à®•à®à¯à®šà®¿ à®®à®±à¯à®±à¯à®®à¯ à®…à®¤à®©à¯ à®¤à®®à®¿à®´à¯ à®ªà¯Šà®°à¯à®³à¯ˆ à®ªà¯Šà®°à¯à®¤à¯à®¤à®µà¯à®®à¯</div>
      <div class="match-grid">
        ${items.map(item => `
          <div id="${item.id}" class="match-item ${matched.has(item.pair) ? 'matched' : ''} ${item.type==='kanji'?'match-kanji-item':'match-meaning-item'}"
            onclick="selectMatch('${item.id}', ${item.pair}, '${item.type}')">
            ${item.val}
          </div>
        `).join('')}
      </div>
      ${matched.size/2 === qs.length ? `<div class="card text-center" style="margin-top:16px"><div style="font-size:1.5rem">ğŸ‰</div><div style="font-weight:800;margin:8px 0">All matched! Errors: ${errors}</div><button class="btn btn-primary btn-block" onclick="quizBackToMenu()">Done</button></div>` : ''}
    `;
  }

  window.selectMatch = (id, pair, type) => {
    if (matched.has(pair)) return;
    const el = document.getElementById(id);
    if (!selected) {
      if (el.classList.contains('matched')) return;
      selected = {id, pair, type};
      el.classList.add('selected');
    } else {
      if (selected.id === id) { el.classList.remove('selected'); selected = null; return; }
      if (selected.pair === pair && selected.type !== type) {
        matched.add(pair);
        selected = null;
        quizState.score++;
        showToast('âœ“ à®ªà¯Šà®°à¯à®¤à¯à®¤à®®à¯!', 'success');
      } else {
        errors++;
        el.classList.add('wrong-flash');
        document.getElementById(selected.id).classList.add('wrong-flash');
        selected = null;
        setTimeout(() => { document.querySelectorAll('.wrong-flash').forEach(e => e.classList.remove('wrong-flash', 'selected')); }, 500);
      }
      render();
      return;
    }
    // re-render to show selection
    const selEl = document.getElementById(selected.id);
    if (selEl) selEl.classList.add('selected');
  };

  render();
}

// Flashcard state
let fcIdx = 0;

function renderFlashcards() {
  const area = document.getElementById('quiz-flashcard-area');
  fcIdx = 0;
  renderFC();
}

function renderFC() {
  const area = document.getElementById('quiz-flashcard-area');
  const qs = quizState.questions;
  if (fcIdx >= qs.length) {
    area.innerHTML = `<div class="card text-center"><div style="font-size:2rem">âœ…</div><div style="font-weight:800;margin:8px 0">All ${qs.length} cards done!</div><div style="color:var(--text2);font-size:0.8rem;margin-bottom:16px">Known: ${quizState.score} / ${qs.length}</div><button class="btn btn-primary btn-block" onclick="quizBackToMenu()">Finish</button></div>`;
    return;
  }
  const k = qs[fcIdx];
  const globalIdx = KANJI.indexOf(k);
  area.innerHTML = `
    <div class="quiz-header">
      <button class="quiz-back" onclick="quizBackToMenu()">â†</button>
      <div class="quiz-title">ğŸƒ Flashcard Mode</div>
      <div class="quiz-score">${fcIdx+1}/${qs.length}</div>
    </div>
    <div class="quiz-progress-bar" style="margin-bottom:16px">
      <div class="quiz-progress-fill" style="width:${Math.round(fcIdx/qs.length*100)}%"></div>
    </div>
    <div class="flashcard-wrap" onclick="flipFC(this)">
      <div class="flashcard" id="fc-card">
        <div class="flashcard-face flashcard-front">
          <div class="flashcard-kanji-big">${k.char}</div>
          <div class="flashcard-tap">ã‚¿ãƒƒãƒ—ã—ã¦ç¢ºèª â€¢ Tap to reveal</div>
        </div>
        <div class="flashcard-face flashcard-back">
          <div class="flashcard-back-content">
            <div class="fb-meaning">${k.meaning}</div>
            <div class="fb-tamil">${k.tamil}</div>
            <div class="fb-readings">
              ${k.onyomi.map(r => `<span class="reading-pill on">éŸ³ ${r}</span>`).join('')}
              ${k.kunyomi.map(r => `<span class="reading-pill kun">è¨“ ${r}</span>`).join('')}
            </div>
            ${k.examples[0] ? `<div style="font-size:0.72rem;color:var(--text2)"><ruby>${k.examples[0].word}<rt>${k.examples[0].reading}</rt></ruby> â€” ${k.examples[0].tamil}</div>` : ''}
          </div>
        </div>
      </div>
    </div>
    <div class="fc-btns" id="fc-action-btns" style="display:none">
      <button class="btn btn-danger" onclick="fcAnswer('difficult')">âœ• Hard</button>
      <button class="btn btn-success" onclick="fcAnswer('known')">âœ“ Known</button>
    </div>
    <div style="text-align:center;font-size:0.7rem;color:var(--text3);margin-top:12px">Flip the card, then rate yourself</div>
  `;
}

function flipFC(wrap) {
  const card = document.getElementById('fc-card');
  card.classList.toggle('flipped');
  document.getElementById('fc-action-btns').style.display = card.classList.contains('flipped') ? 'grid' : 'none';
}

function fcAnswer(status) {
  const k = quizState.questions[fcIdx];
  const idx = KANJI.indexOf(k);
  setKanjiStatus(idx, status);
  if (status === 'known') { quizState.score++; showToast('âœ“ +1 Known!', 'success'); }
  else showToast('Marked as difficult', 'error');
  fcIdx++;
  setTimeout(renderFC, 200);
}

// ============================================================
// SCORE POPUP
// ============================================================
function showScorePopup(score, total, type) {
  state.quizCount++;
  const key = `best_${type}`;
  if (!state.quizScores[key] || score > state.quizScores[key]) state.quizScores[key] = score;
  saveState();
  addActivity(`Completed ${type} quiz: <strong>${score}/${total}</strong>`);

  const pct = Math.round(score/total*100);
  let emoji = pct >= 80 ? 'ğŸ†' : pct >= 60 ? 'ğŸŠ' : 'ğŸ“š';
  let msg = pct >= 80 ? 'à®šà®¿à®±à®¨à¯à®¤à®¤à¯! Excellent work!' : pct >= 60 ? 'à®¨à®²à¯à®²à®¤à¯! Keep it up!' : 'à®¤à¯Šà®Ÿà®°à¯à®¨à¯à®¤à¯ à®ªà®¯à®¿à®±à¯à®šà®¿ à®šà¯†à®¯à¯à®¯à¯à®™à¯à®•à®³à¯!';
  document.getElementById('sp-emoji').textContent = emoji;
  document.getElementById('sp-score').textContent = `${score}/${total}`;
  document.getElementById('sp-msg').textContent = msg;
  document.getElementById('score-popup').classList.add('open');
}

function closeScorePopup() {
  document.getElementById('score-popup').classList.remove('open');
  quizBackToMenu();
}

function renderBestScores() {
  const el = document.getElementById('best-scores');
  const types = [['mcq','ğŸ¯ Meaning Quiz'],['reading','ğŸ“– Reading Quiz'],['match','ğŸ”— Match Game'],['flashcard','ğŸƒ Flashcards']];
  el.innerHTML = types.map(([type, label]) => {
    const best = state.quizScores[`best_${type}`] || 0;
    return `<div class="card card-sm" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
      <span style="font-size:0.82rem;font-weight:700">${label}</span>
      <span style="color:var(--accent);font-weight:800;font-size:0.9rem">Best: ${best}/10</span>
    </div>`;
  }).join('');
}

// ============================================================
// WRITING PRACTICE
// ============================================================
let canvas, ctx;
let drawingStrokes = [];
let currentStroke = [];
let isDrawing = false;
let showHint = true;
let writeKanjiIdx = 0;

function initCanvas() {
  canvas = document.getElementById('writing-canvas');
  if (!canvas) return;
  ctx = canvas.getContext('2d');
  const size = Math.min(canvas.parentElement.offsetWidth - 16, 400);
  canvas.width = size;
  canvas.height = size;
  canvas.style.width = '100%';
  canvas.style.height = 'auto';

  // Mouse events
  canvas.addEventListener('mousedown', startDraw);
  canvas.addEventListener('mousemove', draw);
  canvas.addEventListener('mouseup', endDraw);
  canvas.addEventListener('mouseleave', endDraw);
  // Touch events
  canvas.addEventListener('touchstart', e => { e.preventDefault(); startDraw(e.touches[0]); }, { passive: false });
  canvas.addEventListener('touchmove', e => { e.preventDefault(); draw(e.touches[0]); }, { passive: false });
  canvas.addEventListener('touchend', e => { e.preventDefault(); endDraw(); }, { passive: false });

  redrawCanvas();
}

function getPos(e) {
  const rect = canvas.getBoundingClientRect();
  const scaleX = canvas.width / rect.width;
  const scaleY = canvas.height / rect.height;
  return {
    x: (e.clientX - rect.left) * scaleX,
    y: (e.clientY - rect.top) * scaleY
  };
}

function startDraw(e) {
  isDrawing = true;
  currentStroke = [];
  const pos = getPos(e);
  currentStroke.push(pos);
  ctx.beginPath();
  ctx.moveTo(pos.x, pos.y);
}

function draw(e) {
  if (!isDrawing) return;
  const pos = getPos(e);
  currentStroke.push(pos);
  ctx.strokeStyle = '#1a0a2e';
  ctx.lineWidth = Math.max(canvas.width/60, 4);
  ctx.lineCap = 'round';
  ctx.lineJoin = 'round';
  ctx.lineTo(pos.x, pos.y);
  ctx.stroke();
  ctx.beginPath();
  ctx.moveTo(pos.x, pos.y);
}

function endDraw() {
  if (!isDrawing) return;
  isDrawing = false;
  if (currentStroke.length > 2) {
    drawingStrokes.push([...currentStroke]);
    const cnt = document.getElementById('stroke-count');
    if (cnt) cnt.textContent = drawingStrokes.length;
  }
}

function redrawCanvas() {
  if (!ctx) return;
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = '#fafaf8';
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Grid lines
  ctx.strokeStyle = 'rgba(0,0,0,0.06)';
  ctx.lineWidth = 1;
  ctx.setLineDash([5,5]);
  ctx.beginPath();
  ctx.moveTo(canvas.width/2, 0); ctx.lineTo(canvas.width/2, canvas.height);
  ctx.moveTo(0, canvas.height/2); ctx.lineTo(canvas.width, canvas.height/2);
  ctx.stroke();
  ctx.setLineDash([]);

  // Redraw all strokes
  drawingStrokes.forEach(stroke => {
    ctx.beginPath();
    ctx.strokeStyle = '#1a0a2e';
    ctx.lineWidth = Math.max(canvas.width/60, 4);
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
    stroke.forEach((pt, i) => { if(i===0) ctx.moveTo(pt.x, pt.y); else ctx.lineTo(pt.x, pt.y); });
    ctx.stroke();
  });
}

function clearCanvas() {
  drawingStrokes = [];
  if (ctx) redrawCanvas();
  const cnt = document.getElementById('stroke-count');
  if (cnt) cnt.textContent = '0';
  const fb = document.getElementById('write-feedback');
  if (fb) fb.textContent = '';
}

function undoStroke() {
  if (drawingStrokes.length > 0) {
    drawingStrokes.pop();
    redrawCanvas();
    const cnt = document.getElementById('stroke-count');
    if (cnt) cnt.textContent = drawingStrokes.length;
  }
}

function toggleHint() {
  showHint = !showHint;
  const hint = document.getElementById('canvas-hint');
  if (hint) hint.style.opacity = showHint ? '1' : '0';
}

function writingDone() {
  const fb = document.getElementById('write-feedback');
  if (!fb) return;
  if (drawingStrokes.length === 0) { fb.textContent = 'âœï¸ Draw the kanji first!'; return; }
  const messages = ['ç´ æ™´ã‚‰ã—ã„ï¼ à®šà®¿à®±à®¨à¯à®¤à®¤à¯!', 'é ‘å¼µã‚Šã¾ã—ãŸï¼ à®¨à®²à¯à®² à®®à¯à®¯à®±à¯à®šà®¿!', 'Good attempt! à®®à¯‡à®²à¯à®®à¯ à®ªà®¯à®¿à®±à¯à®šà®¿ à®šà¯†à®¯à¯à®¯à¯à®™à¯à®•à®³à¯!', 'Keep practicing! à®¤à¯Šà®Ÿà®°à¯à®¨à¯à®¤à¯ à®®à¯à®¯à®±à¯à®šà®¿ à®šà¯†à®¯à¯!'];
  fb.textContent = messages[Math.floor(Math.random()*messages.length)];
  const k = KANJI[writeKanjiIdx];
  addActivity(`Practiced writing: <strong>${k.char}</strong>`);
}

function renderWritingSelector() {
  const sel = document.getElementById('write-selector');
  if (!sel) return;
  sel.innerHTML = KANJI.map((k,i) =>
    `<div class="write-kanji-btn ${i===writeKanjiIdx?'active':''}" onclick="selectWriteKanji(${i})">${k.char}</div>`
  ).join('');
  selectWriteKanji(writeKanjiIdx);
  setTimeout(initCanvas, 50);
}

function selectWriteKanji(idx) {
  writeKanjiIdx = idx;
  const k = KANJI[idx];
  const charEl = document.getElementById('write-current-char');
  const meanEl = document.getElementById('write-current-meaning');
  const tamilEl = document.getElementById('write-current-tamil');
  const readEl = document.getElementById('write-current-readings');
  const hint = document.getElementById('canvas-hint');
  const sel = document.getElementById('write-selector');

  if (charEl) charEl.textContent = k.char;
  if (meanEl) meanEl.textContent = k.meaning;
  if (tamilEl) tamilEl.textContent = k.tamil;
  if (readEl) readEl.innerHTML = k.onyomi.map(r=>`<span class="reading-pill on">éŸ³ ${r}</span>`).join('') + k.kunyomi.map(r=>`<span class="reading-pill kun">è¨“ ${r}</span>`).join('');
  if (hint) hint.textContent = k.char;

  // Update selector UI
  sel.querySelectorAll('.write-kanji-btn').forEach((b,i) => b.classList.toggle('active', i===idx));

  clearCanvas();
  setTimeout(() => { if (!canvas) initCanvas(); else redrawCanvas(); }, 50);
}

// ============================================================
// PROGRESS VIEW
// ============================================================
function renderProgress() {
  const sc = getStatusCounts();
  document.getElementById('pg-known').textContent = sc.known;
  document.getElementById('pg-streak').textContent = state.streak;
  document.getElementById('pg-diff').textContent = sc.diff;
  document.getElementById('pg-quiz').textContent = state.quizCount;

  // JLPT breakdown
  const jlptEl = document.getElementById('jlpt-progress');
  const levels = ['N5','N4','N3','N2','N1'];
  const colors = ['var(--green)','var(--blue)','var(--purple)','var(--pink)','var(--red)'];
  jlptEl.innerHTML = levels.map((lvl, li) => {
    const total = KANJI.filter(k => k.jlpt === lvl).length;
    const known = KANJI.map((k,i) => ({...k,i})).filter(k => k.jlpt === lvl && getKanjiStatus(k.i) === 'known').length;
    const pct = total > 0 ? Math.round(known/total*100) : 0;
    return `<div class="progress-bar-item">
      <div class="pb-header">
        <span class="pb-label"><span class="tag tag-${lvl.toLowerCase()}">${lvl}</span> ${lvl} Kanji</span>
        <span class="pb-value">${known}/${total} (${pct}%)</span>
      </div>
      <div class="pb-track"><div class="pb-fill" style="width:${pct}%;background:${colors[li]}"></div></div>
    </div>`;
  }).join('');

  // Recent activity
  const actEl = document.getElementById('recent-activity');
  if (state.recentActivity.length === 0) {
    actEl.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ“–</div><div class="empty-text">à®‡à®©à¯à®©à¯à®®à¯ à®šà¯†à®¯à®²à¯à®ªà®¾à®Ÿà¯ à®‡à®²à¯à®²à¯ˆ. à®ªà®Ÿà®¿à®•à¯à®• à®†à®°à®®à¯à®ªà®¿à®¯à¯à®™à¯à®•à®³à¯!</div></div>';
  } else {
    actEl.innerHTML = state.recentActivity.slice(0,10).map(a => {
      const ago = Math.round((Date.now()-a.time)/60000);
      const timeStr = ago < 1 ? 'Just now' : ago < 60 ? `${ago}m ago` : `${Math.round(ago/60)}h ago`;
      return `<div class="activity-item">
        <div class="activity-icon" style="background:var(--card2)">ğŸ“Œ</div>
        <div class="activity-text">${a.text}</div>
        <div class="activity-time">${timeStr}</div>
      </div>`;
    }).join('');
  }
}

// ============================================================
// SETTINGS
// ============================================================
function toggleSetting(key) {
  state.settings[key] = !state.settings[key];
  document.getElementById(`toggle-${key}`).classList.toggle('on', state.settings[key]);
  saveState();
}

function exportData() {
  const data = JSON.stringify(state, null, 2);
  const blob = new Blob([data], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'kanji-master-progress.json'; a.click();
  URL.revokeObjectURL(url);
  showToast('Progress exported!', 'success');
}

function resetData() {
  if (confirm('All progress will be deleted. Are you sure? / à®¨à®¿à®šà¯à®šà®¯à®®à®¾à®• à®…à®´à®¿à®•à¯à®•à®µà¯‡à®£à¯à®Ÿà¯à®®à®¾?')) {
    localStorage.removeItem('kanjiMasterState');
    location.reload();
  }
}

// ============================================================
// TOAST
// ============================================================
function showToast(msg, type = '') {
  const container = document.getElementById('toast-container');
  const toast = document.createElement('div');
  toast.className = `toast ${type}`;
  toast.textContent = msg;
  container.appendChild(toast);
  setTimeout(() => { toast.style.opacity = '0'; toast.style.transform = 'translateY(-10px)'; setTimeout(() => toast.remove(), 300); }, 1800);
}

// ============================================================
// INIT
// ============================================================
function initSettings() {
  Object.keys(state.settings).forEach(key => {
    const el = document.getElementById(`toggle-${key}`);
    if (el) el.classList.toggle('on', state.settings[key]);
  });
}

function init() {
  loadState();
  renderHome();
  renderLibraryFilters();
  renderLibrary();
  renderLessonsList();
  renderBestScores();
  initSettings();
  updateHeaderStats();

  // Update streak
  const today = new Date().toDateString();
  if (state.lastStudyDate !== today) {
    if (state.lastStudyDate !== new Date(Date.now()-86400000).toDateString()) state.streak = 0;
  }
}

init();
</script>
</body>
</html>
